{"version":3,"file":"CRyydqBq1m1fyAJP14I.js","names":["file"],"sources":["../../node_modules/bootstrap-icons/icons/save.svg?component","../../node_modules/bootstrap-icons/icons/x-square.svg?component","../../app/components/ltLocationInput.vue","../../app/components/ltLocationInput.vue","../../node_modules/bootstrap-icons/icons/caret-down.svg?component","../../node_modules/bootstrap-icons/icons/caret-right.svg?component","../../node_modules/bootstrap-icons/icons/camera-fill.svg?component","../../node_modules/bootstrap-icons/icons/exclamation-triangle-fill.svg?component","../../node_modules/bootstrap-icons/icons/house-fill.svg?component","../../node_modules/bootstrap-icons/icons/question-circle.svg?component","../../app/components/ltFileDetails.vue","../../app/components/ltFileDetails.vue","../../node_modules/bootstrap-icons/icons/house-fill.svg?raw","../../node_modules/leaflet/dist/images/marker-icon-2x.png?no-inline","../../node_modules/leaflet/dist/images/marker-icon.png?no-inline","../../node_modules/leaflet/dist/images/marker-shadow.png?no-inline","../../app/components/ltMap.vue","../../app/components/ltMap.vue","../../node_modules/bootstrap-icons/icons/search.svg?component","../../app/components/ltGeolocate.vue","../../app/components/ltGeolocate.vue"],"sourcesContent":["<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-save\" viewBox=\"0 0 16 16\">\n  <path d=\"M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1z\"/>\n</svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-x-square\" viewBox=\"0 0 16 16\">\n  <path d=\"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z\"/>\n  <path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708\"/>\n</svg>","<template>\n  <div class=\"input-group\">\n    <input\n      ref=\"inputElement\"\n      :value=\"modelValue.csv\"\n      class=\"form-control\"\n      type=\"text\"\n      @blur=\"updateLatLng(($event.target as HTMLInputElement).value)\"\n      @paste=\"\n        updateLatLng($event.clipboardData?.getData('text'));\n        $event.preventDefault();\n      \"\n    />\n    <button\n      class=\"btn btn-outline-secondary\"\n      type=\"button\"\n      :title=\"t('Discard')\"\n      @click=\"rollback()\"\n    >\n      <XSquare />\n    </button>\n    <button\n      class=\"btn btn-outline-success\"\n      type=\"button\"\n      :title=\"t('Save')\"\n      :disabled=\"!modelValue?.isChanged\"\n      @click=\"emit('editLocation')\"\n    >\n      <Save />\n    </button>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {ref} from 'vue';\nimport {LatLng} from '../model';\nimport {t} from './useI18n';\nimport Save from 'bootstrap-icons/icons/save.svg?component';\nimport XSquare from 'bootstrap-icons/icons/x-square.svg?component';\n\n// Support lat,lon\n// Support https://geohack.toolforge.org/geohack.php?pagename=Category:War_memorial,_Schwoich&params=47.54427805_N_12.14066878_E_globe:Earth_&language=en-gb\nconst REGEXP = /(?<lat>[+-]?\\d+\\.?\\d*)(_(?<ns>[NS]))?[_,;\\s]+(?<lng>[+-]?\\d+\\.?\\d*)(_(?<ew>[EW]))?/;\n\nconst modelValue = defineModel<LatLng>({required: true});\n\nconst emit = defineEmits<{\n  editLocation: [];\n}>();\nconst type = ref(modelValue.value?.type);\nconst inputElement = ref<HTMLInputElement | null>(null);\n\nfunction updateLatLng(viewValue: string | undefined) {\n  if (viewValue === undefined) return;\n  if (!type.value) {\n    // keep track of coordinate type since it is lost\n    // when returning undefined on invalid input\n    const t = modelValue.value?.type;\n    if (t) type.value = t;\n  }\n  const m = viewValue.match(REGEXP);\n  const valid = !!m || !viewValue;\n  inputElement.value?.classList?.toggle('is-invalid', !valid);\n  if (!valid) return;\n\n  modelValue.value = new LatLng(\n    type.value!,\n    m?.groups ? parseFloat(m.groups.lat) * (m.groups.ns === 'S' ? -1 : 1) : undefined,\n    m?.groups ? parseFloat(m.groups.lng) * (m.groups.ew === 'W' ? -1 : 1) : undefined,\n    modelValue.value.lat,\n    modelValue.value.lng\n  );\n}\n\nfunction rollback() {\n  modelValue.value = modelValue.value?.rollback();\n}\n</script>\n","<template>\n  <div class=\"input-group\">\n    <input\n      ref=\"inputElement\"\n      :value=\"modelValue.csv\"\n      class=\"form-control\"\n      type=\"text\"\n      @blur=\"updateLatLng(($event.target as HTMLInputElement).value)\"\n      @paste=\"\n        updateLatLng($event.clipboardData?.getData('text'));\n        $event.preventDefault();\n      \"\n    />\n    <button\n      class=\"btn btn-outline-secondary\"\n      type=\"button\"\n      :title=\"t('Discard')\"\n      @click=\"rollback()\"\n    >\n      <XSquare />\n    </button>\n    <button\n      class=\"btn btn-outline-success\"\n      type=\"button\"\n      :title=\"t('Save')\"\n      :disabled=\"!modelValue?.isChanged\"\n      @click=\"emit('editLocation')\"\n    >\n      <Save />\n    </button>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {ref} from 'vue';\nimport {LatLng} from '../model';\nimport {t} from './useI18n';\nimport Save from 'bootstrap-icons/icons/save.svg?component';\nimport XSquare from 'bootstrap-icons/icons/x-square.svg?component';\n\n// Support lat,lon\n// Support https://geohack.toolforge.org/geohack.php?pagename=Category:War_memorial,_Schwoich&params=47.54427805_N_12.14066878_E_globe:Earth_&language=en-gb\nconst REGEXP = /(?<lat>[+-]?\\d+\\.?\\d*)(_(?<ns>[NS]))?[_,;\\s]+(?<lng>[+-]?\\d+\\.?\\d*)(_(?<ew>[EW]))?/;\n\nconst modelValue = defineModel<LatLng>({required: true});\n\nconst emit = defineEmits<{\n  editLocation: [];\n}>();\nconst type = ref(modelValue.value?.type);\nconst inputElement = ref<HTMLInputElement | null>(null);\n\nfunction updateLatLng(viewValue: string | undefined) {\n  if (viewValue === undefined) return;\n  if (!type.value) {\n    // keep track of coordinate type since it is lost\n    // when returning undefined on invalid input\n    const t = modelValue.value?.type;\n    if (t) type.value = t;\n  }\n  const m = viewValue.match(REGEXP);\n  const valid = !!m || !viewValue;\n  inputElement.value?.classList?.toggle('is-invalid', !valid);\n  if (!valid) return;\n\n  modelValue.value = new LatLng(\n    type.value!,\n    m?.groups ? parseFloat(m.groups.lat) * (m.groups.ns === 'S' ? -1 : 1) : undefined,\n    m?.groups ? parseFloat(m.groups.lng) * (m.groups.ew === 'W' ? -1 : 1) : undefined,\n    modelValue.value.lat,\n    modelValue.value.lng\n  );\n}\n\nfunction rollback() {\n  modelValue.value = modelValue.value?.rollback();\n}\n</script>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-caret-down\" viewBox=\"0 0 16 16\">\n  <path d=\"M3.204 5h9.592L8 10.481zm-.753.659 4.796 5.48a1 1 0 0 0 1.506 0l4.796-5.48c.566-.647.106-1.659-.753-1.659H3.204a1 1 0 0 0-.753 1.659\"/>\n</svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-caret-right\" viewBox=\"0 0 16 16\">\n  <path d=\"M6 12.796V3.204L11.481 8zm.659.753 5.48-4.796a1 1 0 0 0 0-1.506L6.66 2.451C6.011 1.885 5 2.345 5 3.204v9.592a1 1 0 0 0 1.659.753\"/>\n</svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-camera-fill\" viewBox=\"0 0 16 16\">\n  <path d=\"M10.5 8.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0\"/>\n  <path d=\"M2 4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-1.172a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 9.172 2H6.828a2 2 0 0 0-1.414.586l-.828.828A2 2 0 0 1 3.172 4zm.5 2a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1m9 2.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0\"/>\n</svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-exclamation-triangle-fill\" viewBox=\"0 0 16 16\">\n  <path d=\"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5m.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2\"/>\n</svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-house-fill\" viewBox=\"0 0 16 16\">\n  <path d=\"M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L8 2.207l6.646 6.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293z\"/>\n  <path d=\"m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293z\"/>\n</svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-question-circle\" viewBox=\"0 0 16 16\">\n  <path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\"/>\n  <path d=\"M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286m1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94\"/>\n</svg>","<template>\n  <button\n    class=\"btn btn-success form-control\"\n    type=\"button\"\n    :disabled=\"!(coordinates?.isChanged || objectLocation?.isChanged)\"\n    @click=\"editLocation()\"\n  >\n    <span class=\"icon-link\">\n      <Save />\n      {{ t('Save') }}\n      <kbd v-if=\"isMacOS\">⌘ + S</kbd>\n      <kbd v-else>Ctrl + S</kbd>\n    </span>\n  </button>\n  <div class=\"card mt-2\">\n    <div class=\"card-body p-2\">\n      <div>\n        <label class=\"icon-link\" @click=\"collapseCameraLocation = !collapseCameraLocation\">\n          <CaretRight v-if=\"collapseCameraLocation\" />\n          <CaretDown v-else />\n          <CameraFill />\n          <!-- eslint-disable-next-line vue/no-v-html -->\n          <span v-html=\"msgCameraLocation\"></span>\n          <abbr\n            v-show=\"!collapseCameraLocation\"\n            :title=\"t('Left click on map to set the location.')\"\n          >\n            <QuestionCircle />\n          </abbr>\n        </label>\n        <div v-show=\"!collapseCameraLocation\">\n          <lt-location-input v-model=\"coordinates\" @edit-location=\"editLocation([coordinates])\" />\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"card mt-2\">\n    <div class=\"card-body p-2\">\n      <div>\n        <label class=\"icon-link\" @click=\"collapseObjectLocation = !collapseObjectLocation\">\n          <CaretRight v-if=\"collapseObjectLocation\" />\n          <CaretDown v-else />\n          <HouseFill />\n          <!-- eslint-disable-next-line vue/no-v-html -->\n          <span v-html=\"msgObjectLocation\"></span>\n          <abbr\n            v-show=\"!collapseObjectLocation\"\n            :title=\"t('Press shift and click on map to set the object location.')\"\n          >\n            <QuestionCircle />\n          </abbr>\n        </label>\n        <div v-show=\"!collapseObjectLocation\">\n          <lt-location-input\n            v-model=\"objectLocation\"\n            @edit-location=\"editLocation([objectLocation])\"\n          />\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div v-if=\"error\" class=\"alert alert-danger mt-2\">\n    <ExclamationTriangleFill class=\"me-1\" />\n    <span>{{ msgErrorStatusText }}</span>\n  </div>\n\n  <div class=\"card mt-2\">\n    <h5 class=\"card-header p-2\">\n      <strong>{{ file.file }}</strong>\n      {{ ' ' }}\n      <small v-if=\"file.url\">\n        <a :href=\"file.url\" target=\"_blank\">\n          <BoxArrowUpRight />\n        </a>\n      </small>\n    </h5>\n    <div class=\"card-body p-2\">\n      <lt-file-metadata :file=\"file\" />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {computed, ref} from 'vue';\nimport {useMagicKeys, whenever} from '@vueuse/core';\nimport * as ltDataAuth from '../api/ltDataAuth';\nimport {CommonsFile, LatLng} from '../model';\nimport ltFileMetadata from './ltFileMetadata.vue';\nimport ltLocationInput from './ltLocationInput.vue';\nimport {FileDetails} from '../api/ltData';\nimport {t} from './useI18n';\nimport CaretDown from 'bootstrap-icons/icons/caret-down.svg?component';\nimport CaretRight from 'bootstrap-icons/icons/caret-right.svg?component';\nimport BoxArrowUpRight from 'bootstrap-icons/icons/box-arrow-up-right.svg?component';\nimport CameraFill from 'bootstrap-icons/icons/camera-fill.svg?component';\nimport ExclamationTriangleFill from 'bootstrap-icons/icons/exclamation-triangle-fill.svg?component';\nimport HouseFill from 'bootstrap-icons/icons/house-fill.svg?component';\nimport QuestionCircle from 'bootstrap-icons/icons/question-circle.svg?component';\nimport Save from 'bootstrap-icons/icons/save.svg?component';\n\nconst coordinates = defineModel<LatLng>('coordinates', {required: true});\nconst objectLocation = defineModel<LatLng>('objectLocation', {required: true});\nconst props = defineProps<{file: CommonsFile & FileDetails}>();\nconst error = ref<unknown>(undefined);\nconst collapseCameraLocation = ref(false);\nconst collapseObjectLocation = ref(false);\n\nconst msgCameraLocation = computed(() =>\n  t(\n    'Camera location via\\n<a href=\"https://commons.wikimedia.org/wiki/Template:Location\" target=\"_blank\"><code class=\"mediawiki-template\">Location</code></a>'\n  )\n);\nconst msgObjectLocation = computed(() =>\n  t(\n    'Object location via\\n<a href=\"https://commons.wikimedia.org/wiki/Template:Object_location\" target=\"_blank\"><code class=\"mediawiki-template\">Object location</code></a>'\n  )\n);\nconst msgErrorStatusText = computed(() =>\n  t('Failed to save: {{$ctrl.error.statusText}}').replace(\n    '{{$ctrl.error.statusText}}',\n    error.value?.statusText\n  )\n);\n\nconst isMacOS = computed(() => navigator.platform.toUpperCase().includes('MAC'));\n\nconst keys = useMagicKeys({\n  passive: false,\n  onEventFired(e) {\n    if (e.type === 'keydown' && e.key === 's' && (e.ctrlKey || e.metaKey)) {\n      // Prevent default save action\n      e.preventDefault();\n    }\n  }\n});\nwhenever(keys['Ctrl+S'], () => editLocation());\nwhenever(keys['Meta+S'], () => editLocation());\n\nasync function editLocation(cc?: LatLng[]) {\n  cc ??= [coordinates.value, objectLocation.value].filter(c => c.isChanged);\n  try {\n    error.value = undefined;\n    await ltDataAuth.editLocation(props.file, cc);\n    for (const c of cc!) {\n      if (c.type === 'Location') {\n        coordinates.value = c.commit();\n      } else if (c.type === 'Object location') {\n        objectLocation.value = c.commit();\n      }\n    }\n  } catch (e) {\n    error.value = e;\n  }\n}\n</script>\n","<template>\n  <button\n    class=\"btn btn-success form-control\"\n    type=\"button\"\n    :disabled=\"!(coordinates?.isChanged || objectLocation?.isChanged)\"\n    @click=\"editLocation()\"\n  >\n    <span class=\"icon-link\">\n      <Save />\n      {{ t('Save') }}\n      <kbd v-if=\"isMacOS\">⌘ + S</kbd>\n      <kbd v-else>Ctrl + S</kbd>\n    </span>\n  </button>\n  <div class=\"card mt-2\">\n    <div class=\"card-body p-2\">\n      <div>\n        <label class=\"icon-link\" @click=\"collapseCameraLocation = !collapseCameraLocation\">\n          <CaretRight v-if=\"collapseCameraLocation\" />\n          <CaretDown v-else />\n          <CameraFill />\n          <!-- eslint-disable-next-line vue/no-v-html -->\n          <span v-html=\"msgCameraLocation\"></span>\n          <abbr\n            v-show=\"!collapseCameraLocation\"\n            :title=\"t('Left click on map to set the location.')\"\n          >\n            <QuestionCircle />\n          </abbr>\n        </label>\n        <div v-show=\"!collapseCameraLocation\">\n          <lt-location-input v-model=\"coordinates\" @edit-location=\"editLocation([coordinates])\" />\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"card mt-2\">\n    <div class=\"card-body p-2\">\n      <div>\n        <label class=\"icon-link\" @click=\"collapseObjectLocation = !collapseObjectLocation\">\n          <CaretRight v-if=\"collapseObjectLocation\" />\n          <CaretDown v-else />\n          <HouseFill />\n          <!-- eslint-disable-next-line vue/no-v-html -->\n          <span v-html=\"msgObjectLocation\"></span>\n          <abbr\n            v-show=\"!collapseObjectLocation\"\n            :title=\"t('Press shift and click on map to set the object location.')\"\n          >\n            <QuestionCircle />\n          </abbr>\n        </label>\n        <div v-show=\"!collapseObjectLocation\">\n          <lt-location-input\n            v-model=\"objectLocation\"\n            @edit-location=\"editLocation([objectLocation])\"\n          />\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div v-if=\"error\" class=\"alert alert-danger mt-2\">\n    <ExclamationTriangleFill class=\"me-1\" />\n    <span>{{ msgErrorStatusText }}</span>\n  </div>\n\n  <div class=\"card mt-2\">\n    <h5 class=\"card-header p-2\">\n      <strong>{{ file.file }}</strong>\n      {{ ' ' }}\n      <small v-if=\"file.url\">\n        <a :href=\"file.url\" target=\"_blank\">\n          <BoxArrowUpRight />\n        </a>\n      </small>\n    </h5>\n    <div class=\"card-body p-2\">\n      <lt-file-metadata :file=\"file\" />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {computed, ref} from 'vue';\nimport {useMagicKeys, whenever} from '@vueuse/core';\nimport * as ltDataAuth from '../api/ltDataAuth';\nimport {CommonsFile, LatLng} from '../model';\nimport ltFileMetadata from './ltFileMetadata.vue';\nimport ltLocationInput from './ltLocationInput.vue';\nimport {FileDetails} from '../api/ltData';\nimport {t} from './useI18n';\nimport CaretDown from 'bootstrap-icons/icons/caret-down.svg?component';\nimport CaretRight from 'bootstrap-icons/icons/caret-right.svg?component';\nimport BoxArrowUpRight from 'bootstrap-icons/icons/box-arrow-up-right.svg?component';\nimport CameraFill from 'bootstrap-icons/icons/camera-fill.svg?component';\nimport ExclamationTriangleFill from 'bootstrap-icons/icons/exclamation-triangle-fill.svg?component';\nimport HouseFill from 'bootstrap-icons/icons/house-fill.svg?component';\nimport QuestionCircle from 'bootstrap-icons/icons/question-circle.svg?component';\nimport Save from 'bootstrap-icons/icons/save.svg?component';\n\nconst coordinates = defineModel<LatLng>('coordinates', {required: true});\nconst objectLocation = defineModel<LatLng>('objectLocation', {required: true});\nconst props = defineProps<{file: CommonsFile & FileDetails}>();\nconst error = ref<unknown>(undefined);\nconst collapseCameraLocation = ref(false);\nconst collapseObjectLocation = ref(false);\n\nconst msgCameraLocation = computed(() =>\n  t(\n    'Camera location via\\n<a href=\"https://commons.wikimedia.org/wiki/Template:Location\" target=\"_blank\"><code class=\"mediawiki-template\">Location</code></a>'\n  )\n);\nconst msgObjectLocation = computed(() =>\n  t(\n    'Object location via\\n<a href=\"https://commons.wikimedia.org/wiki/Template:Object_location\" target=\"_blank\"><code class=\"mediawiki-template\">Object location</code></a>'\n  )\n);\nconst msgErrorStatusText = computed(() =>\n  t('Failed to save: {{$ctrl.error.statusText}}').replace(\n    '{{$ctrl.error.statusText}}',\n    error.value?.statusText\n  )\n);\n\nconst isMacOS = computed(() => navigator.platform.toUpperCase().includes('MAC'));\n\nconst keys = useMagicKeys({\n  passive: false,\n  onEventFired(e) {\n    if (e.type === 'keydown' && e.key === 's' && (e.ctrlKey || e.metaKey)) {\n      // Prevent default save action\n      e.preventDefault();\n    }\n  }\n});\nwhenever(keys['Ctrl+S'], () => editLocation());\nwhenever(keys['Meta+S'], () => editLocation());\n\nasync function editLocation(cc?: LatLng[]) {\n  cc ??= [coordinates.value, objectLocation.value].filter(c => c.isChanged);\n  try {\n    error.value = undefined;\n    await ltDataAuth.editLocation(props.file, cc);\n    for (const c of cc!) {\n      if (c.type === 'Location') {\n        coordinates.value = c.commit();\n      } else if (c.type === 'Object location') {\n        objectLocation.value = c.commit();\n      }\n    }\n  } catch (e) {\n    error.value = e;\n  }\n}\n</script>\n","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" fill=\\\"currentColor\\\" class=\\\"bi bi-house-fill\\\" viewBox=\\\"0 0 16 16\\\">\\n  <path d=\\\"M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L8 2.207l6.646 6.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293z\\\"/>\\n  <path d=\\\"m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293z\\\"/>\\n</svg>\"","export default \"__VITE_ASSET__FKNdLzKnlftW3t_gzo81yw__\"","export default \"__VITE_ASSET__8HSUfh7cJHNFxCkInNzNXw__\"","export default \"__VITE_ASSET__WPGYjwIlzWVNM1bYhOc83w__\"","<template>\n  <div ref=\"mapRef\" class=\"map h-100\" style=\"min-height: 300px\"></div>\n</template>\n\n<script setup lang=\"ts\">\nimport * as L from 'leaflet';\nimport {LatLng} from '../model';\nimport {onMounted, ref, watch} from 'vue';\nimport {useLeafletMap} from './useLeafletMap';\nimport type {MapView} from './useLeafletMap';\nimport HouseFill from 'bootstrap-icons/icons/house-fill.svg?raw';\nimport iconRetinaUrl from 'leaflet/dist/images/marker-icon-2x.png?no-inline';\nimport iconUrl from 'leaflet/dist/images/marker-icon.png?no-inline';\nimport shadowUrl from 'leaflet/dist/images/marker-shadow.png?no-inline';\n\nconst coordinates = defineModel<LatLng>('coordinates', {required: true});\nconst objectLocation = defineModel<LatLng>('objectLocation', {required: true});\n\ndefineEmits<{\n  mapViewChanged: [mapView: MapView];\n}>();\n\nconst mapRef = ref<HTMLElement | null>(null);\n\nonMounted(() => {\n  const {map} = useLeafletMap(mapRef);\n\n  map.on('click', $event => mapClick($event));\n\n  watch(coordinates, mapMarkerUpdater(map), {immediate: true});\n  watch(objectLocation, mapMarkerUpdater(map), {immediate: true});\n});\n\nfunction mapMarkerUpdater(map: L.Map): (mapMarker: LatLng) => void {\n  let marker: L.Marker | undefined;\n  return mapMarker => {\n    const {lat, lng} = mapMarker;\n    if (mapMarker.isDefined && marker) {\n      map.setView({lat, lng});\n      marker.setLatLng({lat, lng});\n    } else if (mapMarker.isDefined) {\n      map.setView({lat, lng});\n      const icon =\n        mapMarker.type === 'Location'\n          ? new L.Icon({\n              iconRetinaUrl,\n              iconUrl,\n              shadowUrl,\n              iconSize: [25, 41],\n              iconAnchor: [12, 41],\n              popupAnchor: [1, -34],\n              tooltipAnchor: [16, -28],\n              shadowSize: [41, 41]\n            })\n          : new L.DivIcon({\n              className: 'b-0',\n              html: `<div title=\"Object location\" style=\"color: red\">${HouseFill}</div>`,\n              iconAnchor: [6, 6],\n              iconSize: [12, 12]\n            });\n      marker = new L.Marker({lat, lng}, {draggable: true, icon})\n        .on('moveend', $event => markerMoveend($event as L.LeafletMouseEvent, mapMarker))\n        .addTo(map);\n    } else if (marker) {\n      marker.remove();\n      marker = undefined;\n    }\n  };\n}\n\nfunction mapClick($event: L.LeafletMouseEvent): void {\n  // http://leafletjs.com/reference.html#mouse-event\n  const {\n    latlng: {lat, lng},\n    originalEvent: {shiftKey}\n  } = $event;\n  if (!lat || !lng) return;\n  setLatLng(shiftKey ? 'Object location' : 'Location', lat, lng);\n}\n\nfunction markerMoveend($event: L.LeafletMouseEvent, target: LatLng): void {\n  const {lat, lng} = ($event.target as L.Marker).getLatLng();\n  if (!lat || !lng) return;\n  setLatLng(target.type, lat, lng);\n}\n\nfunction setLatLng(type: LatLng['type'], lat: number, lng: number) {\n  if (type === 'Object location') {\n    objectLocation.value = objectLocation.value.withLatLng(lat, lng).roundToPrecision();\n  } else {\n    coordinates.value = coordinates.value.withLatLng(lat, lng).roundToPrecision();\n  }\n}\n</script>\n","<template>\n  <div ref=\"mapRef\" class=\"map h-100\" style=\"min-height: 300px\"></div>\n</template>\n\n<script setup lang=\"ts\">\nimport * as L from 'leaflet';\nimport {LatLng} from '../model';\nimport {onMounted, ref, watch} from 'vue';\nimport {useLeafletMap} from './useLeafletMap';\nimport type {MapView} from './useLeafletMap';\nimport HouseFill from 'bootstrap-icons/icons/house-fill.svg?raw';\nimport iconRetinaUrl from 'leaflet/dist/images/marker-icon-2x.png?no-inline';\nimport iconUrl from 'leaflet/dist/images/marker-icon.png?no-inline';\nimport shadowUrl from 'leaflet/dist/images/marker-shadow.png?no-inline';\n\nconst coordinates = defineModel<LatLng>('coordinates', {required: true});\nconst objectLocation = defineModel<LatLng>('objectLocation', {required: true});\n\ndefineEmits<{\n  mapViewChanged: [mapView: MapView];\n}>();\n\nconst mapRef = ref<HTMLElement | null>(null);\n\nonMounted(() => {\n  const {map} = useLeafletMap(mapRef);\n\n  map.on('click', $event => mapClick($event));\n\n  watch(coordinates, mapMarkerUpdater(map), {immediate: true});\n  watch(objectLocation, mapMarkerUpdater(map), {immediate: true});\n});\n\nfunction mapMarkerUpdater(map: L.Map): (mapMarker: LatLng) => void {\n  let marker: L.Marker | undefined;\n  return mapMarker => {\n    const {lat, lng} = mapMarker;\n    if (mapMarker.isDefined && marker) {\n      map.setView({lat, lng});\n      marker.setLatLng({lat, lng});\n    } else if (mapMarker.isDefined) {\n      map.setView({lat, lng});\n      const icon =\n        mapMarker.type === 'Location'\n          ? new L.Icon({\n              iconRetinaUrl,\n              iconUrl,\n              shadowUrl,\n              iconSize: [25, 41],\n              iconAnchor: [12, 41],\n              popupAnchor: [1, -34],\n              tooltipAnchor: [16, -28],\n              shadowSize: [41, 41]\n            })\n          : new L.DivIcon({\n              className: 'b-0',\n              html: `<div title=\"Object location\" style=\"color: red\">${HouseFill}</div>`,\n              iconAnchor: [6, 6],\n              iconSize: [12, 12]\n            });\n      marker = new L.Marker({lat, lng}, {draggable: true, icon})\n        .on('moveend', $event => markerMoveend($event as L.LeafletMouseEvent, mapMarker))\n        .addTo(map);\n    } else if (marker) {\n      marker.remove();\n      marker = undefined;\n    }\n  };\n}\n\nfunction mapClick($event: L.LeafletMouseEvent): void {\n  // http://leafletjs.com/reference.html#mouse-event\n  const {\n    latlng: {lat, lng},\n    originalEvent: {shiftKey}\n  } = $event;\n  if (!lat || !lng) return;\n  setLatLng(shiftKey ? 'Object location' : 'Location', lat, lng);\n}\n\nfunction markerMoveend($event: L.LeafletMouseEvent, target: LatLng): void {\n  const {lat, lng} = ($event.target as L.Marker).getLatLng();\n  if (!lat || !lng) return;\n  setLatLng(target.type, lat, lng);\n}\n\nfunction setLatLng(type: LatLng['type'], lat: number, lng: number) {\n  if (type === 'Object location') {\n    objectLocation.value = objectLocation.value.withLatLng(lat, lng).roundToPrecision();\n  } else {\n    coordinates.value = coordinates.value.withLatLng(lat, lng).roundToPrecision();\n  }\n}\n</script>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-search\" viewBox=\"0 0 16 16\">\n  <path d=\"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0\"/>\n</svg>","<template>\n  <div v-if=\"isLoading\" class=\"row mt-3\">\n    <div class=\"col-sm-12\">\n      <div class=\"jumbotron\">\n        <p>{{ t('Loading file details …') }}</p>\n        <lt-spinner />\n      </div>\n    </div>\n  </div>\n\n  <div v-if=\"!isLoading && !$titles?.length\" class=\"row mt-3\">\n    <div class=\"col-sm-12\">\n      <div class=\"alert alert-warning\">\n        <ExclamationTriangleFill class=\"me-1\" />\n        <!-- eslint-disable-next-line vue/no-v-html -->\n        <span v-if=\"category\" v-html=\"msgNoFilesForCategory\"></span>\n        <!-- eslint-disable-next-line vue/no-v-html -->\n        <span v-if=\"user\" v-html=\"msgNoFilesForUser\"></span>\n      </div>\n    </div>\n  </div>\n\n  <div\n    v-if=\"!isLoading && $titles?.length\"\n    class=\"row flex-grow-1 mt-3\"\n    style=\"--bs-gutter-x: 0.5rem\"\n  >\n    <div\n      class=\"col-lg-3 col-xl-2 mt-3 mt-lg-0 h-100 col-lg-h40\"\n      style=\"overflow-y: scroll; overflow-x: hidden\"\n    >\n      <div class=\"progress\">\n        <div\n          class=\"progress-bar\"\n          role=\"progressbar\"\n          :style=\"{width: titlesDefinedAndSavedPercent + '%'}\"\n        >\n          {{ titlesDefinedAndSaved.length }} / {{ $titles?.length }}\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <div class=\"checkbox\">\n          <label>\n            <input v-model=\"$showGeolocated\" type=\"checkbox\" />\n            <span>{{ t('Also show geolocated files') }}</span>\n          </label>\n        </div>\n      </div>\n      <div class=\"input-group\">\n        <div class=\"input-group-text\">\n          <Search />\n        </div>\n        <input v-model=\"$filter\" class=\"form-control\" type=\"text\" />\n      </div>\n      <div tabindex=\"1\" @keydown=\"keyPressedInList($event)\">\n        <TransitionGroup tag=\"ul\" name=\"list\" class=\"list-group\">\n          <li\n            v-for=\"title in filteredTitles\"\n            :key=\"title.file\"\n            class=\"list-group-item py-1 px-2 text-truncate\"\n            :class=\"{'list-group-item-info': $title === title}\"\n            role=\"button\"\n            @click=\"$title = title\"\n          >\n            <span class=\"icon-link\">\n              <abbr v-if=\"title.coordinates.isDefinedAndSaved\" title=\"Location ✔\">\n                <CameraFill />\n              </abbr>\n              <abbr v-if=\"title.objectLocation.isDefinedAndSaved\" title=\"Object location ✔\">\n                <HouseFill />\n              </abbr>\n              <span>{{ title.file }}</span>\n            </span>\n          </li>\n        </TransitionGroup>\n      </div>\n    </div>\n\n    <div\n      v-if=\"$title\"\n      class=\"col-lg-9 col-xl-3 mt-3 mt-lg-0 h-100 col-lg-h40\"\n      style=\"overflow-y: scroll; overflow-x: hidden\"\n    >\n      <div class=\"row\">\n        <div class=\"col-lg-5 col-xl-12\">\n          <lt-file-details\n            v-model:coordinates=\"$title.coordinates\"\n            v-model:object-location=\"$title.objectLocation\"\n            :file=\"$title\"\n          />\n        </div>\n        <div class=\"col-lg-7 col-xl-12 mt-2\">\n          <lt-file-thumbnail :file=\"$title\" />\n        </div>\n      </div>\n    </div>\n\n    <div v-if=\"$title\" class=\"col-lg-12 col-xl-7 mt-3 mt-lg-0 h-100 col-lg-h60\">\n      <lt-map\n        v-model:coordinates=\"$title.coordinates\"\n        v-model:object-location=\"$title.objectLocation\"\n      />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {ref, computed, onMounted, watch} from 'vue';\nimport * as ltData from '../api/ltData';\nimport {CommonsFile} from '../model';\nimport ltSpinner from './ltSpinner.vue';\nimport ltFileDetails from './ltFileDetails.vue';\nimport ltFileThumbnail from './ltFileThumbnail.vue';\nimport ltMap from './ltMap.vue';\nimport {t} from './useI18n';\nimport {useAppTitle, routeTitlePart} from './useAppTitle';\nimport CameraFill from 'bootstrap-icons/icons/camera-fill.svg?component';\nimport ExclamationTriangleFill from 'bootstrap-icons/icons/exclamation-triangle-fill.svg?component';\nimport HouseFill from 'bootstrap-icons/icons/house-fill.svg?component';\nimport Search from 'bootstrap-icons/icons/search.svg?component';\nimport {useLtRoute} from './useLtRoute';\n\nconst {$query} = useLtRoute();\nconst category = $query.value.category;\nconst user = $query.value.user;\nconst $error = ref<unknown>();\nconst $filter = ref('');\nconst $showGeolocated = ref(false);\nconst $title = ref<CommonsFile | undefined>(undefined);\nconst $titles = ref<CommonsFile[] | undefined>(undefined);\nconst isLoading = ref(false);\n\nuseAppTitle(routeTitlePart(), t('Geolocate files'));\n\nonMounted(async () => {\n  isLoading.value = true;\n  const titles0 = await ltData.getFiles($query.value);\n  const titles = await ltData.getCoordinates(titles0);\n  $titles.value = titles.sort((t1, t2) => t1.file.localeCompare(t2.file));\n  $showGeolocated.value = $titles.value.length <= 5;\n  $title.value = filteredTitles.value[0]; // select first visible title\n  isLoading.value = false;\n});\n\nwatch($title, title => title && titleChanged(title));\n\nfunction _hasLocation(title: CommonsFile) {\n  return title.coordinates.isDefinedAndSaved || title.objectLocation.isDefinedAndSaved;\n}\n\nconst filteredTitles = computed((): CommonsFile[] => {\n  let titles = $titles.value || [];\n  titles = $showGeolocated.value ? titles : titles.filter(t => !_hasLocation(t));\n  titles = titles.filter(t => JSON.stringify(t).includes($filter.value));\n  return titles;\n});\n\nconst titlesDefinedAndSaved = computed((): CommonsFile[] => {\n  return $titles.value ? $titles.value.filter(t => _hasLocation(t)) : [];\n});\n\nconst titlesDefinedAndSavedPercent = computed((): number => {\n  return (100 * titlesDefinedAndSaved.value.length) / ($titles.value || []).length;\n});\n\nfunction keyPressedInList($event: KeyboardEvent): void {\n  const titles = filteredTitles.value;\n  const direction = keydownToDirection($event);\n  if (direction === undefined || $title.value === undefined) {\n    return;\n  }\n  const index = titles.indexOf($title.value);\n  const newIndex = direction + index;\n  if (newIndex >= 0 && titles[newIndex]) {\n    $title.value = titles[newIndex];\n    const target = $event.target as HTMLElement;\n    window.requestAnimationFrame(() =>\n      target.querySelectorAll('.list-group-item')?.[newIndex]?.scrollIntoView?.({block: 'center'})\n    );\n  }\n}\n\nfunction titleChanged(title: CommonsFile): void {\n  $error.value = undefined;\n  // if (title?.coordinates) {\n  //   updateMapView(title.coordinates);\n  // }\n  if (title?.pageid) {\n    ltData.getFileDetails(title.pageid).then(fileDetails => {\n      Object.assign(title, fileDetails);\n      // const {lat, lng} = title.objectLocation;\n      // if (!title.coordinates?.lat) {\n      //   updateMapView({lat, lng});\n      // }\n    });\n  }\n}\n\nfunction keydownToDirection($event: KeyboardEvent) {\n  if ($event && $event.key) {\n    switch ($event.key) {\n      case 'Right':\n      case 'ArrowRight':\n      case 'Down':\n      case 'ArrowDown':\n        $event.preventDefault();\n        return 1;\n      case 'Left':\n      case 'ArrowLeft':\n      case 'Up':\n      case 'ArrowUp':\n        $event.preventDefault();\n        return -1;\n    }\n  }\n}\n\nconst msgNoFilesForCategory = computed(() =>\n  t('Fetched 0 files for category <code>{{$ctrl.category}}</code>!').replace(\n    '{{$ctrl.category}}',\n    category\n  )\n);\nconst msgNoFilesForUser = computed(() =>\n  t('Fetched 0 files for user <code>{{$ctrl.user}}</code>!').replace('{{$ctrl.user}}', user)\n);\n</script>\n\n<style scoped>\n@media (min-width: 768px) and (max-width: 1199px) {\n  .col-lg-h40 {\n    height: 40%;\n  }\n  .col-lg-h60 {\n    height: 60%;\n  }\n}\n\n.list-move,\n.list-enter-active,\n.list-leave-active {\n  transition: all 0.5s ease;\n}\n\n.list-enter-from,\n.list-leave-to {\n  opacity: 0;\n  line-height: 0;\n}\n</style>\n","<template>\n  <div v-if=\"isLoading\" class=\"row mt-3\">\n    <div class=\"col-sm-12\">\n      <div class=\"jumbotron\">\n        <p>{{ t('Loading file details …') }}</p>\n        <lt-spinner />\n      </div>\n    </div>\n  </div>\n\n  <div v-if=\"!isLoading && !$titles?.length\" class=\"row mt-3\">\n    <div class=\"col-sm-12\">\n      <div class=\"alert alert-warning\">\n        <ExclamationTriangleFill class=\"me-1\" />\n        <!-- eslint-disable-next-line vue/no-v-html -->\n        <span v-if=\"category\" v-html=\"msgNoFilesForCategory\"></span>\n        <!-- eslint-disable-next-line vue/no-v-html -->\n        <span v-if=\"user\" v-html=\"msgNoFilesForUser\"></span>\n      </div>\n    </div>\n  </div>\n\n  <div\n    v-if=\"!isLoading && $titles?.length\"\n    class=\"row flex-grow-1 mt-3\"\n    style=\"--bs-gutter-x: 0.5rem\"\n  >\n    <div\n      class=\"col-lg-3 col-xl-2 mt-3 mt-lg-0 h-100 col-lg-h40\"\n      style=\"overflow-y: scroll; overflow-x: hidden\"\n    >\n      <div class=\"progress\">\n        <div\n          class=\"progress-bar\"\n          role=\"progressbar\"\n          :style=\"{width: titlesDefinedAndSavedPercent + '%'}\"\n        >\n          {{ titlesDefinedAndSaved.length }} / {{ $titles?.length }}\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <div class=\"checkbox\">\n          <label>\n            <input v-model=\"$showGeolocated\" type=\"checkbox\" />\n            <span>{{ t('Also show geolocated files') }}</span>\n          </label>\n        </div>\n      </div>\n      <div class=\"input-group\">\n        <div class=\"input-group-text\">\n          <Search />\n        </div>\n        <input v-model=\"$filter\" class=\"form-control\" type=\"text\" />\n      </div>\n      <div tabindex=\"1\" @keydown=\"keyPressedInList($event)\">\n        <TransitionGroup tag=\"ul\" name=\"list\" class=\"list-group\">\n          <li\n            v-for=\"title in filteredTitles\"\n            :key=\"title.file\"\n            class=\"list-group-item py-1 px-2 text-truncate\"\n            :class=\"{'list-group-item-info': $title === title}\"\n            role=\"button\"\n            @click=\"$title = title\"\n          >\n            <span class=\"icon-link\">\n              <abbr v-if=\"title.coordinates.isDefinedAndSaved\" title=\"Location ✔\">\n                <CameraFill />\n              </abbr>\n              <abbr v-if=\"title.objectLocation.isDefinedAndSaved\" title=\"Object location ✔\">\n                <HouseFill />\n              </abbr>\n              <span>{{ title.file }}</span>\n            </span>\n          </li>\n        </TransitionGroup>\n      </div>\n    </div>\n\n    <div\n      v-if=\"$title\"\n      class=\"col-lg-9 col-xl-3 mt-3 mt-lg-0 h-100 col-lg-h40\"\n      style=\"overflow-y: scroll; overflow-x: hidden\"\n    >\n      <div class=\"row\">\n        <div class=\"col-lg-5 col-xl-12\">\n          <lt-file-details\n            v-model:coordinates=\"$title.coordinates\"\n            v-model:object-location=\"$title.objectLocation\"\n            :file=\"$title\"\n          />\n        </div>\n        <div class=\"col-lg-7 col-xl-12 mt-2\">\n          <lt-file-thumbnail :file=\"$title\" />\n        </div>\n      </div>\n    </div>\n\n    <div v-if=\"$title\" class=\"col-lg-12 col-xl-7 mt-3 mt-lg-0 h-100 col-lg-h60\">\n      <lt-map\n        v-model:coordinates=\"$title.coordinates\"\n        v-model:object-location=\"$title.objectLocation\"\n      />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {ref, computed, onMounted, watch} from 'vue';\nimport * as ltData from '../api/ltData';\nimport {CommonsFile} from '../model';\nimport ltSpinner from './ltSpinner.vue';\nimport ltFileDetails from './ltFileDetails.vue';\nimport ltFileThumbnail from './ltFileThumbnail.vue';\nimport ltMap from './ltMap.vue';\nimport {t} from './useI18n';\nimport {useAppTitle, routeTitlePart} from './useAppTitle';\nimport CameraFill from 'bootstrap-icons/icons/camera-fill.svg?component';\nimport ExclamationTriangleFill from 'bootstrap-icons/icons/exclamation-triangle-fill.svg?component';\nimport HouseFill from 'bootstrap-icons/icons/house-fill.svg?component';\nimport Search from 'bootstrap-icons/icons/search.svg?component';\nimport {useLtRoute} from './useLtRoute';\n\nconst {$query} = useLtRoute();\nconst category = $query.value.category;\nconst user = $query.value.user;\nconst $error = ref<unknown>();\nconst $filter = ref('');\nconst $showGeolocated = ref(false);\nconst $title = ref<CommonsFile | undefined>(undefined);\nconst $titles = ref<CommonsFile[] | undefined>(undefined);\nconst isLoading = ref(false);\n\nuseAppTitle(routeTitlePart(), t('Geolocate files'));\n\nonMounted(async () => {\n  isLoading.value = true;\n  const titles0 = await ltData.getFiles($query.value);\n  const titles = await ltData.getCoordinates(titles0);\n  $titles.value = titles.sort((t1, t2) => t1.file.localeCompare(t2.file));\n  $showGeolocated.value = $titles.value.length <= 5;\n  $title.value = filteredTitles.value[0]; // select first visible title\n  isLoading.value = false;\n});\n\nwatch($title, title => title && titleChanged(title));\n\nfunction _hasLocation(title: CommonsFile) {\n  return title.coordinates.isDefinedAndSaved || title.objectLocation.isDefinedAndSaved;\n}\n\nconst filteredTitles = computed((): CommonsFile[] => {\n  let titles = $titles.value || [];\n  titles = $showGeolocated.value ? titles : titles.filter(t => !_hasLocation(t));\n  titles = titles.filter(t => JSON.stringify(t).includes($filter.value));\n  return titles;\n});\n\nconst titlesDefinedAndSaved = computed((): CommonsFile[] => {\n  return $titles.value ? $titles.value.filter(t => _hasLocation(t)) : [];\n});\n\nconst titlesDefinedAndSavedPercent = computed((): number => {\n  return (100 * titlesDefinedAndSaved.value.length) / ($titles.value || []).length;\n});\n\nfunction keyPressedInList($event: KeyboardEvent): void {\n  const titles = filteredTitles.value;\n  const direction = keydownToDirection($event);\n  if (direction === undefined || $title.value === undefined) {\n    return;\n  }\n  const index = titles.indexOf($title.value);\n  const newIndex = direction + index;\n  if (newIndex >= 0 && titles[newIndex]) {\n    $title.value = titles[newIndex];\n    const target = $event.target as HTMLElement;\n    window.requestAnimationFrame(() =>\n      target.querySelectorAll('.list-group-item')?.[newIndex]?.scrollIntoView?.({block: 'center'})\n    );\n  }\n}\n\nfunction titleChanged(title: CommonsFile): void {\n  $error.value = undefined;\n  // if (title?.coordinates) {\n  //   updateMapView(title.coordinates);\n  // }\n  if (title?.pageid) {\n    ltData.getFileDetails(title.pageid).then(fileDetails => {\n      Object.assign(title, fileDetails);\n      // const {lat, lng} = title.objectLocation;\n      // if (!title.coordinates?.lat) {\n      //   updateMapView({lat, lng});\n      // }\n    });\n  }\n}\n\nfunction keydownToDirection($event: KeyboardEvent) {\n  if ($event && $event.key) {\n    switch ($event.key) {\n      case 'Right':\n      case 'ArrowRight':\n      case 'Down':\n      case 'ArrowDown':\n        $event.preventDefault();\n        return 1;\n      case 'Left':\n      case 'ArrowLeft':\n      case 'Up':\n      case 'ArrowUp':\n        $event.preventDefault();\n        return -1;\n    }\n  }\n}\n\nconst msgNoFilesForCategory = computed(() =>\n  t('Fetched 0 files for category <code>{{$ctrl.category}}</code>!').replace(\n    '{{$ctrl.category}}',\n    category\n  )\n);\nconst msgNoFilesForUser = computed(() =>\n  t('Fetched 0 files for user <code>{{$ctrl.user}}</code>!').replace('{{$ctrl.user}}', user)\n);\n</script>\n\n<style scoped>\n@media (min-width: 768px) and (max-width: 1199px) {\n  .col-lg-h40 {\n    height: 40%;\n  }\n  .col-lg-h60 {\n    height: 60%;\n  }\n}\n\n.list-move,\n.list-enter-active,\n.list-leave-active {\n  transition: all 0.5s ease;\n}\n\n.list-enter-from,\n.list-leave-to {\n  opacity: 0;\n  line-height: 0;\n}\n</style>\n"],"x_google_ignoreList":[0,1,4,5,6,7,8,9,12,13,14,15,18],"mappings":"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"}