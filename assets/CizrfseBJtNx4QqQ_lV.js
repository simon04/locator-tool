import{r as e,s as t}from"./BXKdr608ngUESnwh9TJ.js";import{A as n,C as r,D as i,E as a,J as o,K as s,L as c,N as l,O as u,P as ee,R as d,T as f,W as p,X as m,a as te,c as ne,d as h,g,i as _,j as v,k as y,n as b,q as x,r as S,s as re,t as ie,v as ae,w as C}from"./index-DKeDeMIW.js";import{t as w}from"./DGmJRoBZvAIi23e6iwk.js";var oe={key:0,class:`mt-4`},se={key:1},ce=[`href`],le={key:2,class:`mt-4`},ue={class:`nav nav-pills my-3`},de={class:`nav-item`},fe={class:`nav-item`},pe={class:`nav-item`},me={class:`mb-4`},he={for:`inputUser`},ge={class:`row`},_e={class:`mb-4 col-sm-4`},ve={for:`inputUserLimit`,"translate-comment":`maximum number of files`},ye={class:`mb-4 col-sm-4`},be={for:`inputUserStart`},xe={class:`mb-4 col-sm-4`},T={for:`inputUserEnd`},E={class:`mb-4`},D=[`disabled`],O=[`disabled`],k=[`disabled`],A=[`disabled`],j={id:`datalistUser`},M=[`value`],Se={class:`row`},Ce={class:`mb-4 col-lg-10`},we={for:`inputCategory`},Te={class:`mb-4 col-lg-2`},Ee={for:`inputCategoryDepth`,"translate-comment":`Depth of category tree`,"translate-context":`Category`},De={class:`mb-4`},Oe=[`disabled`],ke=[`disabled`],Ae=[`disabled`],je=[`disabled`],Me={id:`datalistCategory`},Ne=[`value`],Pe={class:`mb-4`},N={for:`inputTitles`},Fe=[`innerHTML`],Ie={class:`mb-4`},Le=[`disabled`],Re=[`disabled`],ze=[`disabled`],P=function(e){return e[e.CATEGORY=1]=`CATEGORY`,e[e.USER=2]=`USER`,e[e.FILES=3]=`FILES`,e}(P||{}),F=ee({__name:`ltFilesSelector`,setup(ee){let{$query:F}=ie(),I=ae(),L=s(!1),R=s(F.value.user?P.USER:P.CATEGORY),z=s(F.value.category),B=s(J(parseInt,F.value.categoryDepth,3)),V=s([]),H=s(F.value.user),U=s(J(parseInt,F.value.userLimit,void 0)),W=s(F.value.userStart),G=s(F.value.userEnd),K=s([]),q=s(``);function J(e,t,n){if(!t)return n;try{return e(t)}catch{return n}}let{data:Y}=re();g(z,async t=>{L.value=!0;try{V.value=await e(t)}finally{L.value=!1}},{debounce:500}),g(H,async e=>{L.value=!0;try{K.value=await t(e),console.log(K.value)}finally{L.value=!1}},{debounce:500});function X(e=`geolocate`){let t=$.value.join(`|`);I.push({name:e,query:{files:t}})}function Z(e=`geolocate`){I.push({name:e,query:{user:H.value,userLimit:U.value,userStart:W.value,userEnd:G.value}})}function Q(e=`geolocate`){I.push({name:e,query:{category:z.value,categoryDepth:B.value}})}let $=i({get:()=>q.value.split(`
`).map(e=>e?.split(`|`)[0]).filter(e=>e),set:e=>q.value=e?.join(`
`)});function Be(e){try{if(!e.clipboardData)return;let t=e.clipboardData.getData(`text/html`);if(!t||!/<a/.test(t))return;let n=new DOMParser().parseFromString(t,`text/html`).getElementsByTagName(`a`),r={};[...n].map(e=>decodeURI(e.href)).filter(e=>!!e).map(e=>e.replace(/.*File:/,`File:`)).forEach(e=>r[e]=!0),$.value=Object.keys(r),e.preventDefault()}catch(e){console.warn(`Could not parse HTML clipboard content`,e)}}let Ve=i(()=>h(`Hello {{$ctrl.userInfo}}!`).replace(`{{$ctrl.userInfo}}`,Y.value?.user)),He=i(()=>h(`Load {{$ctrl.titleList.length}} files to geolocate`).replace(`{{$ctrl.titleList.length}}`,$.value.length)),Ue=i(()=>h(`Show {{$ctrl.titleList.length}} files on map`).replace(`{{$ctrl.titleList.length}}`,$.value.length)),We=i(()=>h(`Show {{$ctrl.titleList.length}} files as gallery`).replace(`{{$ctrl.titleList.length}}`,$.value.length));return(e,t)=>(c(),v(a,null,[x(Y)?.user?n(``,!0):(c(),v(`h2`,oe,m(x(h)(`Sign in`)),1)),x(Y)?.user?n(``,!0):(c(),v(`p`,se,[u(`span`,null,m(x(h)(`In order to allow locator-tool to modify file description pages, sign in first:`)),1),u(`a`,{class:`btn btn-success icon-link ms-2`,href:x(ne)()},[l(x(te)),u(`span`,null,m(x(h)(`Log in`)),1)],8,ce)])),x(Y)?.user?(c(),v(`p`,le,m(Ve.value),1)):n(``,!0),u(`h2`,null,m(x(h)(`Select files to geolocate`)),1),u(`ul`,ue,[u(`li`,de,[u(`button`,{class:o([`nav-link`,{active:R.value===P.CATEGORY}]),onClick:t[0]||=e=>R.value=P.CATEGORY},m(x(h)(`Category`)),3)]),u(`li`,fe,[u(`button`,{class:o([`nav-link`,{active:R.value===P.USER}]),onClick:t[1]||=e=>R.value=P.USER},m(x(h)(`User files`)),3)]),u(`li`,pe,[u(`button`,{class:o([`nav-link`,{active:R.value===P.FILES}]),onClick:t[2]||=e=>R.value=P.FILES},m(x(h)(`File list`)),3)])]),p(u(`form`,{onSubmit:t[10]||=f(e=>Q(),[`stop`,`prevent`])},[u(`div`,me,[u(`label`,he,m(x(h)(`User`)),1),p(u(`input`,{id:`inputUser`,"onUpdate:modelValue":t[3]||=e=>H.value=e,class:`form-control`,list:`datalistUser`,placeholder:`User:…`},null,512),[[r,H.value]])]),u(`div`,ge,[u(`div`,_e,[u(`label`,ve,m(x(h)(`Limit`)),1),p(u(`input`,{id:`inputUserLimit`,"onUpdate:modelValue":t[4]||=e=>U.value=e,class:`form-control`,type:`number`},null,512),[[r,U.value]])]),u(`div`,ye,[u(`label`,be,m(x(h)(`Start timestamp`)),1),p(u(`input`,{id:`inputUserStart`,"onUpdate:modelValue":t[5]||=e=>W.value=e,class:`form-control`,type:`date`},null,512),[[r,W.value]])]),u(`div`,xe,[u(`label`,T,m(x(h)(`End timestamp`)),1),p(u(`input`,{id:`inputUserEnd`,"onUpdate:modelValue":t[6]||=e=>G.value=e,class:`form-control`,type:`date`},null,512),[[r,G.value]])])]),u(`div`,E,[u(`button`,{class:`btn btn-success icon-link me-2`,disabled:!H.value,onClick:t[7]||=e=>Z()},[l(x(_)),u(`span`,null,m(x(h)(`Load User files to geolocate`)),1)],8,D),u(`button`,{class:`btn btn-secondary icon-link me-2`,disabled:!H.value,onClick:t[8]||=e=>Z(`map`)},[l(x(S)),u(`span`,null,m(x(h)(`Show User files on map`)),1)],8,O),u(`button`,{class:`btn btn-secondary icon-link me-2`,disabled:!H.value,onClick:t[9]||=e=>Z(`gallery`)},[l(x(b)),u(`span`,null,m(x(h)(`Show User files as gallery`)),1)],8,k),u(`input`,{class:`invisible`,type:`submit`,disabled:!H.value},null,8,A),L.value?(c(),y(w,{key:0})):n(``,!0),u(`datalist`,j,[(c(!0),v(a,null,d(K.value,e=>(c(),v(`option`,{key:e,value:e},null,8,M))),128))])])],544),[[C,R.value===P.USER]]),p(u(`form`,{onSubmit:t[16]||=f(e=>Q(),[`stop`,`prevent`])},[u(`div`,Se,[u(`div`,Ce,[u(`label`,we,m(x(h)(`Category`)),1),p(u(`input`,{id:`inputCategory`,"onUpdate:modelValue":t[11]||=e=>z.value=e,class:`form-control`,list:`datalistCategory`,placeholder:`Category:…`},null,512),[[r,z.value]])]),u(`div`,Te,[u(`label`,Ee,m(x(h)(`Depth`)),1),p(u(`input`,{id:`inputCategoryDepth`,"onUpdate:modelValue":t[12]||=e=>B.value=e,class:`form-control`,type:`number`},null,512),[[r,B.value]])])]),u(`div`,De,[u(`button`,{class:`btn btn-success icon-link me-2`,disabled:!z.value,onClick:t[13]||=e=>Q()},[l(x(_)),u(`span`,null,m(x(h)(`Load Category to geolocate`)),1)],8,Oe),u(`button`,{class:`btn btn-secondary icon-link me-2`,disabled:!z.value,onClick:t[14]||=e=>Q(`map`)},[l(x(S)),u(`span`,null,m(x(h)(`Show Category on map`)),1)],8,ke),u(`button`,{class:`btn btn-secondary icon-link me-2`,disabled:!z.value,onClick:t[15]||=e=>Q(`gallery`)},[l(x(b)),u(`span`,null,m(x(h)(`Show Category as gallery`)),1)],8,Ae),u(`input`,{class:`invisible`,type:`submit`,disabled:!z.value},null,8,je)]),L.value?(c(),y(w,{key:0})):n(``,!0),u(`datalist`,Me,[(c(!0),v(a,null,d(V.value,e=>(c(),v(`option`,{key:e,value:e},null,8,Ne))),128))])],544),[[C,R.value===P.CATEGORY]]),p(u(`form`,{onSubmit:t[22]||=f(e=>Q(),[`stop`,`prevent`])},[u(`div`,Pe,[u(`label`,N,m(x(h)(`File list`)),1),p(u(`textarea`,{id:`inputTitles`,"onUpdate:modelValue":t[17]||=e=>q.value=e,class:`form-control`,rows:`10`,placeholder:`File:…`,onPaste:t[18]||=e=>Be(e)},null,544),[[r,q.value]]),u(`p`,{class:`form-text`,innerHTML:x(h)(`When a clipboard content containing HTML code (for instance a copied selection from a Commons gallery) is pasted here, locator-tool tries to extract <code>File:</code>s from the code.`)},null,8,Fe)]),u(`div`,Ie,[u(`button`,{class:`btn btn-success icon-link me-2`,disabled:!$.value.length,onClick:t[19]||=e=>X()},[l(x(_)),u(`span`,null,m(He.value),1)],8,Le),u(`button`,{class:`btn btn-secondary icon-link me-2`,disabled:!$.value.length,onClick:t[20]||=e=>X(`map`)},[l(x(S)),u(`span`,null,m(Ue.value),1)],8,Re),u(`button`,{class:`btn btn-secondary icon-link me-2`,disabled:!$.value.length,onClick:t[21]||=e=>X(`gallery`)},[l(x(b)),u(`span`,null,m(We.value),1)],8,ze)])],544),[[C,R.value===P.FILES]])],64))}});export{F as default};
//# sourceMappingURL=CizrfseBJtNx4QqQ_lV.js.map