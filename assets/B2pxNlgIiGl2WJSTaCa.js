import{A as e,B as t,C as n,D as r,F as i,G as a,J as o,K as s,Q as c,S as l,T as u,U as d,W as f,b as ee,c as p,d as m,e as h,f as te,h as ne,i as re,j as g,o as _,q as ie,v,w as y,x as b,y as x,z as S}from"./index-ByJQWOIH.js";import{d as ae,h as oe}from"./V2Vi4daSBGeejanudd5.js";import{b as C}from"./CckgnFV4TVywy2d5WAr.js";const se={key:0,class:`mt-4`},ce={key:1},le=[`href`],ue={key:2,class:`mt-4`},de={class:`nav nav-pills my-3`},fe={class:`nav-item`},pe={class:`nav-item`},me={class:`nav-item`},he={class:`mb-4`},ge={for:`inputUser`},_e={class:`row`},ve={class:`mb-4 col-sm-4`},ye={for:`inputUserLimit`,"translate-comment":`maximum number of files`},be={class:`mb-4 col-sm-4`},xe={for:`inputUserStart`},w={class:`mb-4 col-sm-4`},T={for:`inputUserEnd`},E={class:`mb-4`},D=[`disabled`],O=[`disabled`],k=[`disabled`],A=[`disabled`],j={id:`datalistUser`},M=[`value`],Se={class:`row`},Ce={class:`mb-4 col-lg-10`},we={for:`inputCategory`},Te={class:`mb-4 col-lg-2`},Ee={for:`inputCategoryDepth`,"translate-comment":`Depth of category tree`,"translate-context":`Category`},De={class:`mb-4`},Oe=[`disabled`],ke=[`disabled`],Ae=[`disabled`],je=[`disabled`],N={id:`datalistCategory`},Me=[`value`],Ne={class:`mb-4`},Pe={for:`inputTitles`},Fe=[`innerHTML`],Ie={class:`mb-4`},Le=[`disabled`],Re=[`disabled`],ze=[`disabled`];var P=function(e){return e[e.CATEGORY=1]=`CATEGORY`,e[e.USER=2]=`USER`,e[e.FILES=3]=`FILES`,e}(P||{}),F=a({__name:`ltFilesSelector`,setup(a){let{$query:F}=ee(),I=ie(),L=l(!1),R=l(F.value.user?P.USER:P.CATEGORY),z=l(F.value.category),B=l(J(parseInt,F.value.categoryDepth,3)),V=l([]),H=l(F.value.user),U=l(J(parseInt,F.value.userLimit,void 0)),W=l(F.value.userStart),G=l(F.value.userEnd),K=l([]),q=l(``);function J(e,t,n){if(!t)return n;try{return e(t)}catch{return n}}let{data:Y}=ne();_(z,async e=>{L.value=!0;try{V.value=await ae(e)}finally{L.value=!1}},{debounce:500}),_(H,async e=>{L.value=!0;try{K.value=await oe(e),console.log(K.value)}finally{L.value=!1}},{debounce:500});function X(e=`geolocate`){let t=$.value.join(`|`);I.push({name:e,query:{files:t}})}function Z(e=`geolocate`){I.push({name:e,query:{user:H.value,userLimit:U.value,userStart:W.value,userEnd:G.value}})}function Q(e=`geolocate`){I.push({name:e,query:{category:z.value,categoryDepth:B.value}})}let $=S({get:()=>q.value.split(`
`).map(e=>e?.split(`|`)[0]).filter(e=>e),set:e=>q.value=e?.join(`
`)});function Be(e){try{if(!e.clipboardData)return;let t=e.clipboardData.getData(`text/html`);if(!t||!/<a/.test(t))return;let n=new DOMParser,r=n.parseFromString(t,`text/html`),i=r.getElementsByTagName(`a`),a={};[...i].map(e=>decodeURI(e.href)).filter(e=>!!e).map(e=>e.replace(/.*File:/,`File:`)).forEach(e=>a[e]=!0),$.value=Object.keys(a),e.preventDefault()}catch(e){console.warn(`Could not parse HTML clipboard content`,e)}}let Ve=S(()=>g(`Hello {{$ctrl.userInfo}}!`).replace(`{{$ctrl.userInfo}}`,Y.value?.user)),He=S(()=>g(`Load {{$ctrl.titleList.length}} files to geolocate`).replace(`{{$ctrl.titleList.length}}`,$.value.length)),Ue=S(()=>g(`Show {{$ctrl.titleList.length}} files on map`).replace(`{{$ctrl.titleList.length}}`,$.value.length)),We=S(()=>g(`Show {{$ctrl.titleList.length}} files as gallery`).replace(`{{$ctrl.titleList.length}}`,$.value.length));return(a,l)=>(o(),r(x,null,[u(Y)?.user?n(``,!0):(o(),r(`h2`,se,f(u(g)(`Sign in`)),1)),u(Y)?.user?n(``,!0):(o(),r(`p`,ce,[e(`span`,null,f(u(g)(`In order to allow locator-tool to modify file description pages, sign in first:`)),1),e(`a`,{class:`btn btn-success icon-link ms-2`,href:u(re)()},[i(u(te)),e(`span`,null,f(u(g)(`Log in`)),1)],8,le)])),u(Y)?.user?(o(),r(`p`,ue,f(Ve.value),1)):n(``,!0),e(`h2`,null,f(u(g)(`Select files to geolocate`)),1),e(`ul`,de,[e(`li`,fe,[e(`button`,{class:d([`nav-link`,{active:R.value===P.CATEGORY}]),onClick:l[0]||=e=>R.value=P.CATEGORY},f(u(g)(`Category`)),3)]),e(`li`,pe,[e(`button`,{class:d([`nav-link`,{active:R.value===P.USER}]),onClick:l[1]||=e=>R.value=P.USER},f(u(g)(`User files`)),3)]),e(`li`,me,[e(`button`,{class:d([`nav-link`,{active:R.value===P.FILES}]),onClick:l[2]||=e=>R.value=P.FILES},f(u(g)(`File list`)),3)])]),c(e(`form`,{onSubmit:l[10]||=b(e=>Q(),[`stop`,`prevent`])},[e(`div`,he,[e(`label`,ge,f(u(g)(`User`)),1),c(e(`input`,{id:`inputUser`,"onUpdate:modelValue":l[3]||=e=>H.value=e,class:`form-control`,list:`datalistUser`,placeholder:`User:…`},null,512),[[v,H.value]])]),e(`div`,_e,[e(`div`,ve,[e(`label`,ye,f(u(g)(`Limit`)),1),c(e(`input`,{id:`inputUserLimit`,"onUpdate:modelValue":l[4]||=e=>U.value=e,class:`form-control`,type:`number`},null,512),[[v,U.value]])]),e(`div`,be,[e(`label`,xe,f(u(g)(`Start timestamp`)),1),c(e(`input`,{id:`inputUserStart`,"onUpdate:modelValue":l[5]||=e=>W.value=e,class:`form-control`,type:`date`},null,512),[[v,W.value]])]),e(`div`,w,[e(`label`,T,f(u(g)(`End timestamp`)),1),c(e(`input`,{id:`inputUserEnd`,"onUpdate:modelValue":l[6]||=e=>G.value=e,class:`form-control`,type:`date`},null,512),[[v,G.value]])])]),e(`div`,E,[e(`button`,{class:`btn btn-success icon-link me-2`,disabled:!H.value,onClick:l[7]||=e=>Z()},[i(u(h)),e(`span`,null,f(u(g)(`Load User files to geolocate`)),1)],8,D),e(`button`,{class:`btn btn-secondary icon-link me-2`,disabled:!H.value,onClick:l[8]||=e=>Z(`map`)},[i(u(m)),e(`span`,null,f(u(g)(`Show User files on map`)),1)],8,O),e(`button`,{class:`btn btn-secondary icon-link me-2`,disabled:!H.value,onClick:l[9]||=e=>Z(`gallery`)},[i(u(p)),e(`span`,null,f(u(g)(`Show User files as gallery`)),1)],8,k),e(`input`,{class:`invisible`,type:`submit`,disabled:!H.value},null,8,A),L.value?(o(),t(C,{key:0})):n(``,!0),e(`datalist`,j,[(o(!0),r(x,null,s(K.value,e=>(o(),r(`option`,{key:e,value:e},null,8,M))),128))])])],544),[[y,R.value===P.USER]]),c(e(`form`,{onSubmit:l[16]||=b(e=>Q(),[`stop`,`prevent`])},[e(`div`,Se,[e(`div`,Ce,[e(`label`,we,f(u(g)(`Category`)),1),c(e(`input`,{id:`inputCategory`,"onUpdate:modelValue":l[11]||=e=>z.value=e,class:`form-control`,list:`datalistCategory`,placeholder:`Category:…`},null,512),[[v,z.value]])]),e(`div`,Te,[e(`label`,Ee,f(u(g)(`Depth`)),1),c(e(`input`,{id:`inputCategoryDepth`,"onUpdate:modelValue":l[12]||=e=>B.value=e,class:`form-control`,type:`number`},null,512),[[v,B.value]])])]),e(`div`,De,[e(`button`,{class:`btn btn-success icon-link me-2`,disabled:!z.value,onClick:l[13]||=e=>Q()},[i(u(h)),e(`span`,null,f(u(g)(`Load Category to geolocate`)),1)],8,Oe),e(`button`,{class:`btn btn-secondary icon-link me-2`,disabled:!z.value,onClick:l[14]||=e=>Q(`map`)},[i(u(m)),e(`span`,null,f(u(g)(`Show Category on map`)),1)],8,ke),e(`button`,{class:`btn btn-secondary icon-link me-2`,disabled:!z.value,onClick:l[15]||=e=>Q(`gallery`)},[i(u(p)),e(`span`,null,f(u(g)(`Show Category as gallery`)),1)],8,Ae),e(`input`,{class:`invisible`,type:`submit`,disabled:!z.value},null,8,je)]),L.value?(o(),t(C,{key:0})):n(``,!0),e(`datalist`,N,[(o(!0),r(x,null,s(V.value,e=>(o(),r(`option`,{key:e,value:e},null,8,Me))),128))])],544),[[y,R.value===P.CATEGORY]]),c(e(`form`,{onSubmit:l[22]||=b(e=>Q(),[`stop`,`prevent`])},[e(`div`,Ne,[e(`label`,Pe,f(u(g)(`File list`)),1),c(e(`textarea`,{id:`inputTitles`,"onUpdate:modelValue":l[17]||=e=>q.value=e,class:`form-control`,rows:`10`,placeholder:`File:…`,onPaste:l[18]||=e=>Be(e)},null,544),[[v,q.value]]),e(`p`,{class:`form-text`,innerHTML:u(g)(`When a clipboard content containing HTML code (for instance a copied selection from a Commons gallery) is pasted here, locator-tool tries to extract <code>File:</code>s from the code.`)},null,8,Fe)]),e(`div`,Ie,[e(`button`,{class:`btn btn-success icon-link me-2`,disabled:!$.value.length,onClick:l[19]||=e=>X()},[i(u(h)),e(`span`,null,f(He.value),1)],8,Le),e(`button`,{class:`btn btn-secondary icon-link me-2`,disabled:!$.value.length,onClick:l[20]||=e=>X(`map`)},[i(u(m)),e(`span`,null,f(Ue.value),1)],8,Re),e(`button`,{class:`btn btn-secondary icon-link me-2`,disabled:!$.value.length,onClick:l[21]||=e=>X(`gallery`)},[i(u(p)),e(`span`,null,f(We.value),1)],8,ze)])],544),[[y,R.value===P.FILES]])],64))}}),I=F;export{I as default};
//# sourceMappingURL=B2pxNlgIiGl2WJSTaCa.js.map