{"version":3,"file":"V2Vi4daSBGeejanudd5.js","names":["e","n","t","r","o","f","u","i","c","a","l","d","h","g","p","s","type: 'Location' | 'Object location'","lat: number | undefined","lng: number | undefined","latOriginal?: number | undefined","lngOriginal?: number | undefined","page: DetailsPage | undefined","mediainfo: MediaInfo","wikitext: string"],"sources":["../../node_modules/wikimedia-commons-file-path/build/wikimedia-commons-file-path.module.js","../../app/model/LatLng.ts","../../app/model/index.ts","../../node_modules/es-toolkit/dist/_internal/isUnsafeProperty.mjs","../../node_modules/es-toolkit/dist/compat/predicate/isObjectLike.mjs","../../node_modules/es-toolkit/dist/object/mergeWith.mjs","../../app/api/ltData.ts"],"sourcesContent":["var n,t,e=\"undefined\"!=typeof globalThis?globalThis:\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:{},r=(n=function(n){!function(t){function e(n,t){var e=(65535&n)+(65535&t);return(n>>16)+(t>>16)+(e>>16)<<16|65535&e}function r(n,t,r,o,u,f){return e((i=e(e(t,n),e(o,f)))<<(c=u)|i>>>32-c,r);var i,c}function o(n,t,e,o,u,f,i){return r(t&e|~t&o,n,t,u,f,i)}function u(n,t,e,o,u,f,i){return r(t&o|e&~o,n,t,u,f,i)}function f(n,t,e,o,u,f,i){return r(t^e^o,n,t,u,f,i)}function i(n,t,e,o,u,f,i){return r(e^(t|~o),n,t,u,f,i)}function c(n,t){var r,c,a,l,d;n[t>>5]|=128<<t%32,n[14+(t+64>>>9<<4)]=t;var h=1732584193,g=-271733879,p=-1732584194,s=271733878;for(r=0;r<n.length;r+=16)c=h,a=g,l=p,d=s,h=o(h,g,p,s,n[r],7,-680876936),s=o(s,h,g,p,n[r+1],12,-389564586),p=o(p,s,h,g,n[r+2],17,606105819),g=o(g,p,s,h,n[r+3],22,-1044525330),h=o(h,g,p,s,n[r+4],7,-176418897),s=o(s,h,g,p,n[r+5],12,1200080426),p=o(p,s,h,g,n[r+6],17,-1473231341),g=o(g,p,s,h,n[r+7],22,-45705983),h=o(h,g,p,s,n[r+8],7,1770035416),s=o(s,h,g,p,n[r+9],12,-1958414417),p=o(p,s,h,g,n[r+10],17,-42063),g=o(g,p,s,h,n[r+11],22,-1990404162),h=o(h,g,p,s,n[r+12],7,1804603682),s=o(s,h,g,p,n[r+13],12,-40341101),p=o(p,s,h,g,n[r+14],17,-1502002290),h=u(h,g=o(g,p,s,h,n[r+15],22,1236535329),p,s,n[r+1],5,-165796510),s=u(s,h,g,p,n[r+6],9,-1069501632),p=u(p,s,h,g,n[r+11],14,643717713),g=u(g,p,s,h,n[r],20,-373897302),h=u(h,g,p,s,n[r+5],5,-701558691),s=u(s,h,g,p,n[r+10],9,38016083),p=u(p,s,h,g,n[r+15],14,-660478335),g=u(g,p,s,h,n[r+4],20,-405537848),h=u(h,g,p,s,n[r+9],5,568446438),s=u(s,h,g,p,n[r+14],9,-1019803690),p=u(p,s,h,g,n[r+3],14,-187363961),g=u(g,p,s,h,n[r+8],20,1163531501),h=u(h,g,p,s,n[r+13],5,-1444681467),s=u(s,h,g,p,n[r+2],9,-51403784),p=u(p,s,h,g,n[r+7],14,1735328473),h=f(h,g=u(g,p,s,h,n[r+12],20,-1926607734),p,s,n[r+5],4,-378558),s=f(s,h,g,p,n[r+8],11,-2022574463),p=f(p,s,h,g,n[r+11],16,1839030562),g=f(g,p,s,h,n[r+14],23,-35309556),h=f(h,g,p,s,n[r+1],4,-1530992060),s=f(s,h,g,p,n[r+4],11,1272893353),p=f(p,s,h,g,n[r+7],16,-155497632),g=f(g,p,s,h,n[r+10],23,-1094730640),h=f(h,g,p,s,n[r+13],4,681279174),s=f(s,h,g,p,n[r],11,-358537222),p=f(p,s,h,g,n[r+3],16,-722521979),g=f(g,p,s,h,n[r+6],23,76029189),h=f(h,g,p,s,n[r+9],4,-640364487),s=f(s,h,g,p,n[r+12],11,-421815835),p=f(p,s,h,g,n[r+15],16,530742520),h=i(h,g=f(g,p,s,h,n[r+2],23,-995338651),p,s,n[r],6,-198630844),s=i(s,h,g,p,n[r+7],10,1126891415),p=i(p,s,h,g,n[r+14],15,-1416354905),g=i(g,p,s,h,n[r+5],21,-57434055),h=i(h,g,p,s,n[r+12],6,1700485571),s=i(s,h,g,p,n[r+3],10,-1894986606),p=i(p,s,h,g,n[r+10],15,-1051523),g=i(g,p,s,h,n[r+1],21,-2054922799),h=i(h,g,p,s,n[r+8],6,1873313359),s=i(s,h,g,p,n[r+15],10,-30611744),p=i(p,s,h,g,n[r+6],15,-1560198380),g=i(g,p,s,h,n[r+13],21,1309151649),h=i(h,g,p,s,n[r+4],6,-145523070),s=i(s,h,g,p,n[r+11],10,-1120210379),p=i(p,s,h,g,n[r+2],15,718787259),g=i(g,p,s,h,n[r+9],21,-343485551),h=e(h,c),g=e(g,a),p=e(p,l),s=e(s,d);return[h,g,p,s]}function a(n){var t,e=\"\",r=32*n.length;for(t=0;t<r;t+=8)e+=String.fromCharCode(n[t>>5]>>>t%32&255);return e}function l(n){var t,e=[];for(e[(n.length>>2)-1]=void 0,t=0;t<e.length;t+=1)e[t]=0;var r=8*n.length;for(t=0;t<r;t+=8)e[t>>5]|=(255&n.charCodeAt(t/8))<<t%32;return e}function d(n){var t,e,r=\"0123456789abcdef\",o=\"\";for(e=0;e<n.length;e+=1)t=n.charCodeAt(e),o+=r.charAt(t>>>4&15)+r.charAt(15&t);return o}function h(n){return unescape(encodeURIComponent(n))}function g(n){return function(n){return a(c(l(n),8*n.length))}(h(n))}function p(n,t){return function(n,t){var e,r,o=l(n),u=[],f=[];for(u[15]=f[15]=void 0,o.length>16&&(o=c(o,8*n.length)),e=0;e<16;e+=1)u[e]=909522486^o[e],f[e]=1549556828^o[e];return r=c(u.concat(l(t)),512+8*t.length),a(c(f.concat(r),640))}(h(n),h(t))}function s(n,t,e){return t?e?p(t,n):d(p(t,n)):e?g(n):d(g(n))}n.exports?n.exports=s:t.md5=s}(e)},n(t={exports:{}}),t.exports);function o(n,t){n=n.replace(/^File:/,\"\").replace(/\\s+/g,\"_\");var e=encodeURIComponent(n),o=\"https://upload.wikimedia.org/wikipedia/commons\",u=r(n),f=u[0]+\"/\"+u[0]+u[1];return t?o+\"/thumb/\"+f+\"/\"+e+\"/\"+t+\"px-\"+e+(n.match(/tiff?$/i)?\".jpg\":n.match(/svg$/i)?\".png\":\"\"):o+\"/\"+f+\"/\"+e}export{o as default};\n//# sourceMappingURL=wikimedia-commons-file-path.module.js.map\n","export class LatLng {\n  constructor(\n    public type: 'Location' | 'Object location',\n    public lat: number | undefined,\n    public lng: number | undefined,\n    private readonly latOriginal?: number | undefined,\n    private readonly lngOriginal?: number | undefined\n  ) {\n    if (arguments.length === 3) {\n      // cannot use fallback value in constructor (latOriginal=lat) since latOriginal may need to be undefined\n      this.latOriginal = lat;\n      this.lngOriginal = lng;\n    }\n  }\n\n  withLatLng(lat: number | undefined, lng: number | undefined): LatLng {\n    return new LatLng(this.type, lat, lng, this.latOriginal, this.lngOriginal);\n  }\n\n  roundToPrecision(): LatLng {\n    return new LatLng(\n      this.type,\n      roundToPrecision(this.lat),\n      roundToPrecision(this.lng),\n      this.latOriginal,\n      this.lngOriginal\n    );\n  }\n\n  rollback(): LatLng {\n    return new LatLng(this.type, this.latOriginal, this.lngOriginal);\n  }\n\n  commit(): LatLng {\n    return new LatLng(this.type, this.lat, this.lng, this.lat, this.lng);\n  }\n\n  get isDefined(): boolean {\n    return this.lat !== undefined && this.lng !== undefined;\n  }\n\n  get isChanged(): boolean {\n    return this.lat !== this.latOriginal || this.lng !== this.lngOriginal;\n  }\n\n  get isDefinedAndSaved(): boolean {\n    return this.isDefined && !this.isChanged;\n  }\n\n  get csv(): string {\n    return this.lat !== undefined && this.lng !== undefined\n      ? [this.lat, this.lng].map(atLeastOneDecimalPlace).join(', ')\n      : '';\n  }\n}\n\nfunction atLeastOneDecimalPlace(value: number) {\n  return value % 1 === 0 ? value.toFixed(1) : value;\n}\n\nfunction roundToPrecision(value: number | undefined, fractionDigits = 5): number | undefined {\n  return typeof value === 'number' ? +value.toFixed(fractionDigits) : value;\n}\n","import {LatLng} from './LatLng';\n\nexport {LatLng} from './LatLng';\n\nexport interface CommonsFile {\n  pageid: number;\n  file: string;\n  url: string;\n  coordinates: LatLng;\n  objectLocation: LatLng;\n  $geolocate?: string; // Vue app in L.Popup has no router\n\n  imageUrl(width?: number): string;\n}\n\nexport type CommonsTitle = string;\n\nexport type User = string;\n\nexport const WikidataProperty = {\n  // coordinate location (P625)\n  '*': 'P625',\n  // coordinates of the point of view (P1259)\n  Location: 'P1259',\n  // coordinates of depicted place (P9149)\n  'Object location': 'P9149'\n};\n","function isUnsafeProperty(key) {\n    return key === '__proto__';\n}\n\nexport { isUnsafeProperty };\n","function isObjectLike(value) {\n    return typeof value === 'object' && value !== null;\n}\n\nexport { isObjectLike };\n","import { isUnsafeProperty } from '../_internal/isUnsafeProperty.mjs';\nimport { isObjectLike } from '../compat/predicate/isObjectLike.mjs';\n\nfunction mergeWith(target, source, merge) {\n    const sourceKeys = Object.keys(source);\n    for (let i = 0; i < sourceKeys.length; i++) {\n        const key = sourceKeys[i];\n        if (isUnsafeProperty(key)) {\n            continue;\n        }\n        const sourceValue = source[key];\n        const targetValue = target[key];\n        const merged = merge(targetValue, sourceValue, key, target, source);\n        if (merged !== undefined) {\n            target[key] = merged;\n        }\n        else if (Array.isArray(sourceValue)) {\n            target[key] = mergeWith(targetValue ?? [], sourceValue, merge);\n        }\n        else if (isObjectLike(targetValue) && isObjectLike(sourceValue)) {\n            target[key] = mergeWith(targetValue ?? {}, sourceValue, merge);\n        }\n        else if (targetValue === undefined || sourceValue !== undefined) {\n            target[key] = sourceValue;\n        }\n    }\n    return target;\n}\n\nexport { mergeWith };\n","import getFilePath from 'wikimedia-commons-file-path';\n\nimport {CommonsFile, CommonsTitle, LatLng, WikidataProperty} from '../model';\nimport {MediaInfo, Statement} from '../model/mediainfo.ts';\nimport {LatLngBounds} from 'leaflet';\nimport {mergeWith} from 'es-toolkit';\n\nexport const API_URL = 'https://commons.wikimedia.org/w/api.php';\nconst NS_FILE = 6;\nconst NS_CATEGORY = 14;\n\ninterface ApiResponse<P = never> {\n  continue: {[key: string]: string} | undefined;\n  batchcomplete: string;\n  query: {\n    pages: {[key: string]: P};\n    categorymembers?: P[];\n    allpages?: P[];\n    allusers?: P[];\n    geosearch?: P[];\n  };\n}\n\ninterface Page {\n  pageid: number;\n  ns: number;\n  title: string;\n}\n\ninterface User {\n  userid: number;\n  name: string;\n}\n\ninterface CoordinatePage {\n  pageid: number;\n  ns: number;\n  title: string;\n  coordinates?: Coordinate[];\n}\n\ninterface Coordinate {\n  lat: number;\n  lon: number;\n  primary?: string;\n  type: 'camera' | 'object';\n}\n\ninterface DetailsPage {\n  pageid: number;\n  ns: number;\n  title: string;\n  categories?: Category[];\n  imagerepository: string;\n  imageinfo: ImageInfo[];\n  revisions?: Revision[];\n}\n\ninterface Category {\n  ns: number;\n  title: string;\n}\n\ninterface ImageInfo {\n  url: string;\n  descriptionurl: string;\n  descriptionshorturl: string;\n  extmetadata: ExtMetadata;\n}\n\ninterface ExtMetadata {\n  ImageDescription: Artist;\n  DateTimeOriginal: Artist;\n  Artist: Artist;\n}\n\ninterface Artist {\n  value: string;\n  source: string;\n}\n\ninterface Revision {\n  slots: Slots;\n}\n\nexport interface Slots {\n  main: MainSlot;\n  mediainfo: MainSlot;\n}\n\nexport interface MainSlot {\n  contentformat: string;\n  contentmodel: string;\n  '*': string;\n}\n\nexport async function getCoordinates(titles: string | CommonsTitle[]): Promise<CommonsFile[]> {\n  if (typeof titles === 'string') {\n    titles = titles.split('|');\n  }\n\n  const url = new URL(\n    buildQuery({\n      prop: 'coordinates',\n      colimit: 500,\n      coprop: 'type|name',\n      coprimary: 'all'\n    })\n  );\n\n  // takeWhile\n  const titles0 = titles.reduce((acc, title, index, array) => {\n    url.searchParams.set('titles', (array as string[]).slice(0, index).join('|'));\n    return url.toString().length < 2000 ? acc.concat(title) : acc;\n  }, [] as CommonsTitle[]);\n\n  if (titles.length > titles0.length) {\n    const coordinates = await Promise.all([\n      getCoordinates(titles0),\n      getCoordinates(titles.slice(titles0.length))\n    ]);\n    return coordinates.flat();\n  }\n\n  url.searchParams.set('titles', titles.join('|').replace(/_/g, ' '));\n  const data = await $query<ApiResponse<CoordinatePage>>(url);\n  const pages = data?.query?.pages || {};\n  return Object.entries(pages).map(([pageid, page]) => {\n    return {\n      pageid: parseInt(pageid),\n      file: page.title,\n      url: `https://commons.wikimedia.org/wiki/${page.title}`,\n      imageUrl(width?: number) {\n        return getFilePath(this.file, width);\n      },\n      coordinates: new LatLng(\n        'Location',\n        ...toLatLng(page.coordinates?.find(c => c.primary === '' && c.type === 'camera'))\n      ),\n      objectLocation: new LatLng(\n        'Object location',\n        ...toLatLng(page.coordinates?.find(c => c.type === 'object'))\n      )\n    } as CommonsFile;\n  });\n\n  function toLatLng(c: Coordinate | undefined): [number?, number?] {\n    return typeof c === 'object' ? [c.lat, c.lon] : [undefined, undefined];\n  }\n}\n\nexport interface FileDetails {\n  categories: string[];\n  description: string;\n  author: string;\n  timestamp: string;\n  url?: string;\n  coordinates?: LatLng;\n  objectLocation?: LatLng;\n}\n\nexport async function getFileDetails(\n  pageid: number,\n  prop = 'categories|imageinfo|revisions|wbentityusage',\n  iiprop = 'url|extmetadata'\n): Promise<FileDetails> {\n  const params = {\n    prop,\n    pageids: pageid,\n    iiprop,\n    iiextmetadatafilter: 'ImageDescription|Artist|DateTimeOriginal',\n    iiextmetadatalanguage: document.body.parentElement!.lang,\n    ...(prop.includes('categories') ? {clshow: '!hidden'} : {}),\n    ...(prop.includes('revisions') ? {rvslots: '*', rvprop: 'content'} : {})\n  };\n  const data = await $query<ApiResponse<DetailsPage>>(params);\n  const page: DetailsPage | undefined = data?.query?.pages?.[pageid];\n  const categories = (page?.categories || []).map(category =>\n    category.title.replace(/^Category:/, '')\n  );\n  const extmetadata = page?.imageinfo[0]?.extmetadata;\n  return {\n    categories,\n    description: extmetadata?.ImageDescription?.value,\n    author: extmetadata?.Artist?.value,\n    timestamp: extmetadata?.DateTimeOriginal?.value,\n    ...(iiprop.includes('url') ? {url: page?.imageinfo[0]?.descriptionurl} : {}),\n    objectLocation: extractObjectLocation(page),\n    ...extractMediaInfo(page)\n  };\n\n  function extractMediaInfo(page: DetailsPage): Partial<FileDetails> {\n    const json = page?.revisions?.[0]?.slots?.mediainfo['*'];\n    if (!json) return {};\n    const mediainfo: MediaInfo = JSON.parse(json);\n    const coordinates = extractMediaInfoLocation(\n      'Location',\n      mediainfo.statements[WikidataProperty['Location']]?.[0]\n    );\n    const objectLocation = extractMediaInfoLocation(\n      'Object location',\n      mediainfo.statements[WikidataProperty['Object location']]?.[0]\n    );\n    return {\n      ...(coordinates ? {coordinates} : {}),\n      ...(objectLocation ? {objectLocation} : {})\n    };\n  }\n\n  function extractMediaInfoLocation(\n    type: LatLng['type'],\n    statement: Statement | undefined\n  ): LatLng | undefined {\n    if (statement?.mainsnak.datavalue?.type !== 'globecoordinate') {\n      return;\n    }\n    return new LatLng(\n      type,\n      statement?.mainsnak.datavalue.value.latitude,\n      statement?.mainsnak.datavalue.value.longitude\n    );\n  }\n\n  function extractObjectLocation(page: DetailsPage) {\n    try {\n      const wikitext: string = page?.revisions?.[0]?.slots?.main['*'] || '';\n      const locDeg = wikitext.match(\n        /\\{\\{Object location( dec)?\\|([0-9]+)\\|([0-9]+)\\|([0-9.]+)\\|([NS])\\|([0-9]+)\\|([0-9]+)\\|([0-9.]+)\\|([WE])/i\n      );\n      const loc = wikitext.match(/\\{\\{Object location( dec)?\\s*\\|\\s*([0-9.]+)\\s*\\|\\s*([0-9.]+)/i);\n      let lat;\n      let lng;\n      if (locDeg) {\n        lat = parseInt(locDeg[2]) + parseInt(locDeg[3]) / 60 + parseFloat(locDeg[4]) / 3600;\n        lat *= locDeg[5] === 'N' ? 1 : -1;\n        lng = parseInt(locDeg[6]) + parseInt(locDeg[7]) / 60 + parseFloat(locDeg[8]) / 3600;\n        lng *= locDeg[9] === 'E' ? 1 : -1;\n      } else if (loc) {\n        lat = parseFloat(loc[2]);\n        lng = parseFloat(loc[3]);\n      }\n      return new LatLng('Object location', lat, lng);\n    } catch {\n      return new LatLng('Object location', undefined, undefined);\n    }\n  }\n}\n\nexport async function getCategoriesForPrefix(prefix: string): Promise<CommonsTitle[]> {\n  const params = {\n    list: 'allpages',\n    apnamespace: NS_CATEGORY,\n    aplimit: 30,\n    apfrom: prefix,\n    apprefix: prefix\n  };\n  const data = await $query<ApiResponse<Page>>(params, {}, undefined, () => false);\n  return (data.query.allpages || []).map(i => i.title.replace(/^Category:/, '' as CommonsTitle));\n}\n\nexport async function getUsersForPrefix(prefix: string): Promise<string[]> {\n  const params = {\n    list: 'allusers',\n    aulimit: 30,\n    aufrom: prefix,\n    apuprefix: prefix\n  };\n  const data = await $query<ApiResponse<User>>(params, {}, undefined, () => false);\n  return (data.query.allusers || []).map(i => i.name);\n}\n\nexport type FilesOptions = {\n  files?: CommonsTitle | CommonsTitle[];\n  user?: string;\n  userLimit?: string;\n  userStart?: string;\n  userEnd?: string;\n  category?: string;\n  categoryDepth?: string;\n};\n\nexport async function getFiles({\n  files,\n  user,\n  userLimit,\n  userStart,\n  userEnd,\n  category,\n  categoryDepth\n}: FilesOptions & {userLimit?: string | number; categoryDepth?: string | number}): Promise<\n  CommonsTitle[]\n> {\n  if (typeof files === 'string') {\n    files = files.split('|');\n  }\n  if (files) {\n    return files.map(file => (file.startsWith('File:') ? file : `File:${file}`));\n  } else if (user) {\n    const userLimit0 = typeof userLimit === 'string' ? +userLimit : userLimit;\n    return getFilesForUser(user, userLimit0, userStart, userEnd);\n  } else if (category) {\n    const categoryDepth0 = typeof categoryDepth === 'string' ? +categoryDepth : categoryDepth;\n    return getFilesForCategory(category, categoryDepth0);\n  } else {\n    throw new Error();\n  }\n}\n\nexport interface Geosearch {\n  pageid: number;\n  ns: number;\n  title: string;\n  lat: number;\n  lon: number;\n  dist: number;\n  primary: string;\n  type: string;\n  name: null;\n}\n\nexport async function geosearch(bounds: LatLngBounds): Promise<CommonsFile[]> {\n  const params = {\n    list: 'geosearch',\n    gsnamespace: NS_FILE,\n    gslimit: 500,\n    gsprop: 'type|name',\n    gsbbox: [bounds.getNorth(), bounds.getWest(), bounds.getSouth(), bounds.getEast()].join('|')\n  };\n  const data = await $query<ApiResponse<Geosearch>>(params, {});\n  return (data.query?.geosearch || []).map(\n    (gs): CommonsFile => ({\n      pageid: gs.pageid,\n      file: gs.title,\n      url: `https://commons.wikimedia.org/wiki/${gs.title}`,\n      imageUrl(width?: number) {\n        return getFilePath(this.file, width);\n      },\n      coordinates: new LatLng('Location', gs.lat, gs.lon),\n      objectLocation: new LatLng('Object location', undefined, undefined)\n    })\n  );\n}\n\nfunction removeCommonsPrefix(string: string, prefix: string): string {\n  const urlPrefix = 'https://commons.wikimedia.org/wiki/';\n  if (string.startsWith(urlPrefix)) {\n    string = string.slice(urlPrefix.length);\n    string = decodeURI(string);\n  }\n  if (string.startsWith(prefix)) {\n    string = string.slice(prefix.length);\n  }\n  return string;\n}\n\nexport async function getFilesForUser(\n  user: string,\n  userLimit: number | undefined,\n  userStart: string | undefined,\n  userEnd: string | undefined\n): Promise<CommonsTitle[]> {\n  user = removeCommonsPrefix(user, 'User:');\n  // https://commons.wikimedia.org/w/api.php?action=help&modules=query%2Ballimages\n  const params = {\n    generator: 'allimages',\n    gaiuser: user,\n    gailimit: typeof userLimit === 'number' && userLimit <= 500 ? userLimit : 'max',\n    gaistart: userEnd ? new Date(userEnd).toISOString() : undefined, // sic! (due to gaidir)\n    gaiend: userStart ? new Date(userStart).toISOString() : undefined, // sic! (due to gaidir)\n    gaisort: 'timestamp',\n    gaidir: 'older'\n  };\n  const toPageArray = (data: ApiResponse<Page>): Page[] => Object.values(data.query.pages);\n  const shouldContinue = (data: ApiResponse<Page>): boolean =>\n    data.continue ? !userLimit || toPageArray(data).length < userLimit : false;\n  const data = await $query<ApiResponse<Page>>(params, {}, undefined, shouldContinue);\n  const pages = toPageArray(data).map(page => page.title as CommonsTitle);\n  return userLimit ? pages.slice(0, userLimit) : pages;\n}\n\nexport async function getFilesForCategory(cat: string, depth = 3): Promise<CommonsTitle[]> {\n  cat = removeCommonsPrefix(cat, 'Category:');\n  const abort = new AbortController();\n  const requests = [\n    getFilesForCategory1(cat, depth, abort.signal),\n    getFilesForCategory2(cat, depth, abort.signal),\n    getFilesForCategory3(cat, depth, abort.signal)\n  ];\n  if (depth <= 0) {\n    requests.unshift(getFilesForCategory0(cat, abort.signal));\n  }\n  try {\n    return await new Promise<CommonsTitle[]>((resolve, reject) => {\n      // resolve first successful one\n      for (const promise of requests) {\n        promise.then(resolve, error => {\n          if (error instanceof DOMException && error.name === 'AbortError') return;\n          console.warn('Error fetching category', cat, error);\n        });\n      }\n      // reject when all fail\n      Promise.allSettled(requests).catch(reject);\n    });\n  } finally {\n    abort.abort();\n  }\n}\n\nexport async function getFilesForCategory0(\n  cat: string,\n  signal?: AbortSignal\n): Promise<CommonsTitle[]> {\n  const params = {\n    list: 'categorymembers',\n    cmlimit: 500,\n    cmnamespace: NS_FILE,\n    cmtitle: 'Category:' + cat\n  };\n  const data = await $query<ApiResponse<Page>>(params, {}, signal);\n  return (data.query.categorymembers || []).map(cm => cm.title);\n}\n\nexport async function getFilesForCategory1(\n  cat: string,\n  depth: number,\n  signal?: AbortSignal\n): Promise<CommonsTitle[]> {\n  const params = {\n    lang: 'commons',\n    cat: cat.replace(/^Category:/, ''),\n    type: NS_FILE,\n    depth,\n    json: 1\n  };\n  const url = 'https://cats-php.toolforge.org/?' + toSearchParams(params);\n  const data = await fetchJSON<CommonsTitle[]>(url, {signal});\n  return data.map(f => `File:${f}`);\n}\n\nexport async function getFilesForCategory2(\n  cat: string,\n  depth: number,\n  signal?: AbortSignal\n): Promise<CommonsTitle[]> {\n  const params = {\n    category: cat.replace(/^Category:/, ''),\n    ns: NS_FILE,\n    depth\n  };\n  const url = '/catscan?' + toSearchParams(params);\n  const data = await fetchJSON<{pages: CommonsTitle[]}>(url, {signal});\n  return data.pages.map(f => `File:${f}`);\n}\n\nexport async function getFilesForCategory3(\n  categories: string,\n  depth: number,\n  signal?: AbortSignal\n): Promise<CommonsTitle[]> {\n  const params = {\n    language: 'commons',\n    project: 'wikimedia',\n    depth,\n    categories,\n    [`ns[${NS_FILE}]`]: 1,\n    format: 'json',\n    sparse: 1,\n    doit: 1\n  };\n  const url = 'https://petscan.wmcloud.org/?' + toSearchParams(params);\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const data = await fetchJSON<any>(url, {signal});\n  return data['*'][0]['a']['*'] as CommonsTitle[];\n}\n\nfunction buildQuery(query: Record<string, unknown> = {}) {\n  const params = {\n    action: 'query',\n    format: 'json',\n    origin: '*',\n    ...query\n  };\n  const url = API_URL + '?' + toSearchParams(params);\n  return url;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nasync function $query<T extends ApiResponse<any>>(\n  query: URL | Record<string, unknown>,\n  previousResults = {},\n  signal?: AbortSignal,\n  shouldContinue = (data: T) => !!data.continue\n): Promise<T> {\n  const url = query instanceof URL ? query.toString() : buildQuery(query);\n  let data = await fetchJSON<T>(url, {\n    signal\n  });\n  data = mergeWith(previousResults, data, (x, y) => {\n    if (Array.isArray(x) && Array.isArray(y)) {\n      return [].concat(...x, ...y);\n    }\n  }) as T;\n  if (shouldContinue(data)) {\n    return $query<T>(\n      {...query, continue: undefined, ...data.continue},\n      {...data, continue: undefined},\n      signal,\n      shouldContinue\n    );\n  }\n  return data;\n}\n\nfunction toSearchParams(query: Record<string, unknown>): URLSearchParams {\n  const searchParams = new URLSearchParams();\n  for (const [key, value] of Object.entries(query)) {\n    if (value === undefined) continue;\n    searchParams.append(key, String(value));\n  }\n  return searchParams;\n}\n\nasync function fetchJSON<T>(url: RequestInfo, options?: RequestInit): Promise<T> {\n  console.log('Fetching', url);\n  const res = await fetch(url, {\n    cache: 'no-cache',\n    headers: {Accept: 'application/json'},\n    ...options\n  });\n  if (res.ok) {\n    return res.json();\n  } else {\n    throw new Error(res.statusText);\n  }\n}\n"],"x_google_ignoreList":[0,3,4,5],"mappings":"AAAA,IAAI,EAAE,EAAE,EAAe,OAAO,WAApB,IAA+B,WAAwB,OAAO,OAApB,IAA2B,OAAoB,OAAO,OAApB,IAA2B,OAAoB,OAAO,KAApB,IAAyB,KAAK,GAAG,GAAG,EAAE,SAAS,EAAE,EAAE,SAAS,EAAE,CAAC,SAASA,EAAE,EAAE,EAAE,CAAC,IAAIA,GAAG,MAAMC,IAAI,MAAMC,GAAG,OAAOD,GAAG,KAAKC,GAAG,KAAKF,GAAG,KAAK,GAAG,MAAMA,EAAE,SAASG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,OAAOH,GAAG,EAAEA,EAAEA,EAAEE,EAAED,GAAGD,EAAEI,EAAEC,OAAO,EAAEC,GAAGC,IAAI,GAAGC,EAAEL,OAAOI,EAAEC,EAAE,SAASJ,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,OAAOD,EAAED,EAAEF,EAAE,CAACE,EAAEE,EAAEH,EAAEC,EAAEI,EAAED,EAAEE,GAAG,SAAS,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,OAAOJ,EAAED,EAAEE,EAAEJ,EAAE,CAACI,EAAEH,EAAEC,EAAEI,EAAED,EAAEE,GAAG,SAAS,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,OAAOJ,EAAED,EAAEF,EAAEI,EAAEH,EAAEC,EAAEI,EAAED,EAAEE,GAAG,SAAS,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,OAAOJ,EAAEH,GAAGE,EAAE,CAACE,GAAGH,EAAEC,EAAEI,EAAED,EAAEE,GAAG,SAAS,EAAE,EAAE,EAAE,CAAC,IAAIJ,EAAEK,EAAEC,EAAEC,EAAEC,EAAE,EAAET,GAAG,IAAI,KAAKA,EAAE,GAAG,EAAE,IAAIA,EAAE,KAAK,GAAG,IAAIA,EAAE,IAAIU,EAAE,WAAWC,EAAE,WAAWC,EAAE,YAAYC,EAAE,UAAU,IAAI,EAAE,EAAEZ,EAAEF,EAAE,OAAO,GAAG,GAAG,EAAEW,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEX,EAAEQ,EAAEC,EAAEC,EAAEC,EAAEd,EAAEE,GAAG,EAAE,YAAY,EAAEC,EAAEW,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,GAAG,GAAG,YAAY,EAAEC,EAAEU,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,GAAG,GAAG,WAAW,EAAEC,EAAES,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,GAAG,GAAG,aAAa,EAAEC,EAAEQ,EAAEC,EAAEC,EAAEC,EAAEd,EAAEE,EAAE,GAAG,EAAE,YAAY,EAAEC,EAAEW,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,GAAG,GAAG,YAAY,EAAEC,EAAEU,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,GAAG,GAAG,aAAa,EAAEC,EAAES,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,GAAG,GAAG,WAAW,EAAEC,EAAEQ,EAAEC,EAAEC,EAAEC,EAAEd,EAAEE,EAAE,GAAG,EAAE,YAAY,EAAEC,EAAEW,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,GAAG,GAAG,aAAa,EAAEC,EAAEU,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,IAAI,GAAG,QAAQ,EAAEC,EAAES,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,IAAI,GAAG,aAAa,EAAEC,EAAEQ,EAAEC,EAAEC,EAAEC,EAAEd,EAAEE,EAAE,IAAI,EAAE,YAAY,EAAEC,EAAEW,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,IAAI,GAAG,WAAW,EAAEC,EAAEU,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,IAAI,GAAG,aAAa,EAAE,EAAES,EAAE,EAAER,EAAES,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,IAAI,GAAG,YAAYW,EAAEC,EAAEd,EAAEE,EAAE,GAAG,EAAE,YAAY,EAAE,EAAEY,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,GAAG,EAAE,aAAa,EAAE,EAAEW,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,IAAI,GAAG,WAAW,EAAE,EAAEU,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,GAAG,GAAG,YAAY,EAAE,EAAES,EAAEC,EAAEC,EAAEC,EAAEd,EAAEE,EAAE,GAAG,EAAE,YAAY,EAAE,EAAEY,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,IAAI,EAAE,UAAU,EAAE,EAAEW,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,IAAI,GAAG,YAAY,EAAE,EAAEU,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,GAAG,GAAG,YAAY,EAAE,EAAES,EAAEC,EAAEC,EAAEC,EAAEd,EAAEE,EAAE,GAAG,EAAE,WAAW,EAAE,EAAEY,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,IAAI,EAAE,aAAa,EAAE,EAAEW,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,GAAG,GAAG,YAAY,EAAE,EAAEU,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,GAAG,GAAG,YAAY,EAAE,EAAES,EAAEC,EAAEC,EAAEC,EAAEd,EAAEE,EAAE,IAAI,EAAE,aAAa,EAAE,EAAEY,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,GAAG,EAAE,WAAW,EAAE,EAAEW,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,GAAG,GAAG,YAAY,EAAE,EAAES,EAAE,EAAE,EAAEC,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,IAAI,GAAG,aAAaW,EAAEC,EAAEd,EAAEE,EAAE,GAAG,EAAE,SAAS,EAAE,EAAEY,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,GAAG,GAAG,aAAa,EAAE,EAAEW,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,IAAI,GAAG,YAAY,EAAE,EAAEU,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,IAAI,GAAG,WAAW,EAAE,EAAES,EAAEC,EAAEC,EAAEC,EAAEd,EAAEE,EAAE,GAAG,EAAE,aAAa,EAAE,EAAEY,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,GAAG,GAAG,YAAY,EAAE,EAAEW,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,GAAG,GAAG,YAAY,EAAE,EAAEU,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,IAAI,GAAG,aAAa,EAAE,EAAES,EAAEC,EAAEC,EAAEC,EAAEd,EAAEE,EAAE,IAAI,EAAE,WAAW,EAAE,EAAEY,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,GAAG,GAAG,YAAY,EAAE,EAAEW,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,GAAG,GAAG,YAAY,EAAE,EAAEU,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,GAAG,GAAG,UAAU,EAAE,EAAES,EAAEC,EAAEC,EAAEC,EAAEd,EAAEE,EAAE,GAAG,EAAE,YAAY,EAAE,EAAEY,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,IAAI,GAAG,YAAY,EAAE,EAAEW,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,IAAI,GAAG,WAAW,EAAE,EAAES,EAAE,EAAE,EAAEC,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,GAAG,GAAG,YAAYW,EAAEC,EAAEd,EAAEE,GAAG,EAAE,YAAY,EAAE,EAAEY,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,GAAG,GAAG,YAAY,EAAE,EAAEW,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,IAAI,GAAG,aAAa,EAAE,EAAEU,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,GAAG,GAAG,WAAW,EAAE,EAAES,EAAEC,EAAEC,EAAEC,EAAEd,EAAEE,EAAE,IAAI,EAAE,YAAY,EAAE,EAAEY,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,GAAG,GAAG,aAAa,EAAE,EAAEW,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,IAAI,GAAG,UAAU,EAAE,EAAEU,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,GAAG,GAAG,aAAa,EAAE,EAAES,EAAEC,EAAEC,EAAEC,EAAEd,EAAEE,EAAE,GAAG,EAAE,YAAY,EAAE,EAAEY,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,IAAI,GAAG,WAAW,EAAE,EAAEW,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,GAAG,GAAG,aAAa,EAAE,EAAEU,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,IAAI,GAAG,YAAY,EAAE,EAAES,EAAEC,EAAEC,EAAEC,EAAEd,EAAEE,EAAE,GAAG,EAAE,YAAY,EAAE,EAAEY,EAAEH,EAAEC,EAAEC,EAAEb,EAAEE,EAAE,IAAI,GAAG,aAAa,EAAE,EAAEW,EAAEC,EAAEH,EAAEC,EAAEZ,EAAEE,EAAE,GAAG,GAAG,WAAW,EAAE,EAAEU,EAAEC,EAAEC,EAAEH,EAAEX,EAAEE,EAAE,GAAG,GAAG,YAAY,EAAEH,EAAEY,EAAEJ,GAAG,EAAER,EAAEa,EAAEJ,GAAG,EAAET,EAAEc,EAAEJ,GAAG,EAAEV,EAAEe,EAAEJ,GAAG,MAAM,CAACC,EAAEC,EAAEC,EAAEC,GAAG,SAAS,EAAE,EAAE,CAAC,IAAIb,EAAEF,EAAE,GAAGG,EAAE,GAAGF,EAAE,OAAO,IAAI,EAAE,EAAEC,EAAEC,EAAE,GAAG,EAAE,GAAG,OAAO,aAAaF,EAAEC,GAAG,KAAKA,EAAE,GAAG,KAAK,OAAOF,EAAE,SAAS,EAAE,EAAE,CAAC,IAAIE,EAAEF,EAAE,GAAG,IAAI,GAAGC,EAAE,QAAQ,GAAG,GAAG,IAAK,GAAE,EAAE,EAAEC,EAAEF,EAAE,OAAO,GAAG,EAAE,EAAEE,GAAG,EAAE,IAAIC,EAAE,EAAEF,EAAE,OAAO,IAAI,EAAE,EAAEC,EAAEC,EAAE,GAAG,EAAE,EAAED,GAAG,KAAK,IAAID,EAAE,WAAWC,EAAE,KAAKA,EAAE,GAAG,OAAOF,EAAE,SAAS,EAAE,EAAE,CAAC,IAAIE,EAAEF,EAAEG,EAAE,mBAAmBC,EAAE,GAAG,IAAI,EAAE,EAAEJ,EAAEC,EAAE,OAAO,GAAG,EAAE,EAAEA,EAAE,WAAWD,GAAG,GAAGG,EAAE,OAAOD,IAAI,EAAE,IAAIC,EAAE,OAAO,GAAGD,GAAG,OAAOE,EAAE,SAAS,EAAE,EAAE,CAAC,OAAO,SAAS,mBAAmBH,IAAI,SAAS,EAAE,EAAE,CAAC,OAAO,SAAS,EAAE,CAAC,OAAO,EAAE,EAAE,EAAEA,GAAG,EAAEA,EAAE,UAAU,EAAEA,IAAI,SAAS,EAAE,EAAE,EAAE,CAAC,OAAO,SAAS,EAAE,EAAE,CAAC,IAAID,EAAEG,EAAEC,EAAE,EAAEH,GAAGK,EAAE,GAAGD,EAAE,GAAG,IAAI,EAAE,IAAI,EAAE,IAAI,IAAK,GAAED,EAAE,OAAO,KAAK,EAAE,EAAEA,EAAE,EAAEH,EAAE,SAAS,EAAE,EAAED,EAAE,GAAG,GAAG,EAAE,EAAEA,GAAG,UAAUI,EAAEJ,GAAG,EAAEA,GAAG,WAAWI,EAAEJ,GAAG,MAAO,GAAE,EAAEM,EAAE,OAAO,EAAEJ,IAAI,IAAI,EAAEA,EAAE,QAAQ,EAAE,EAAEG,EAAE,OAAOF,GAAG,OAAO,EAAEF,GAAG,EAAEC,IAAI,SAAS,EAAE,EAAE,EAAE,EAAE,CAAC,OAAOA,EAAEF,EAAE,EAAEE,EAAED,GAAG,EAAE,EAAEC,EAAED,IAAID,EAAE,EAAEC,GAAG,EAAE,EAAEA,IAAI,EAAE,QAAQ,EAAE,QAAQ,EAAE,EAAE,IAAI,IAAG,IAAI,EAAE,EAAE,CAAC,QAAQ,KAAK,EAAE,SAAS,SAAS,EAAE,EAAE,EAAE,CAAC,EAAEA,EAAE,QAAQ,SAAS,IAAI,QAAQ,OAAO,KAAK,IAAID,EAAE,mBAAmBC,GAAGG,EAAE,iDAAiD,EAAE,EAAEH,GAAG,EAAE,EAAE,GAAG,IAAI,EAAE,GAAG,EAAE,GAAG,OAAOC,EAAEE,EAAE,UAAU,EAAE,IAAIJ,EAAE,IAAIE,EAAE,MAAMF,GAAGC,EAAE,MAAM,WAAW,OAAOA,EAAE,MAAM,SAAS,OAAO,IAAIG,EAAE,IAAI,EAAE,IAAIJ,ECA7hI,IAAa,EAAb,MAAa,CAAO,CAClB,YACE,EACA,EACA,EACA,EACA,EACA,CALO,KAAA,KAAA,EACA,KAAA,IAAA,EACA,KAAA,IAAA,EACU,KAAA,YAAA,EACA,KAAA,YAAA,EAEb,UAAU,SAAW,IAEvB,KAAK,YAAc,EACnB,KAAK,YAAc,GAIvB,WAAW,EAAyB,EAAiC,CACnE,OAAO,IAAI,EAAO,KAAK,KAAM,EAAK,EAAK,KAAK,YAAa,KAAK,aAGhE,kBAA2B,CACzB,OAAO,IAAI,EACT,KAAK,KACL,EAAiB,KAAK,KACtB,EAAiB,KAAK,KACtB,KAAK,YACL,KAAK,aAIT,UAAmB,CACjB,OAAO,IAAI,EAAO,KAAK,KAAM,KAAK,YAAa,KAAK,aAGtD,QAAiB,CACf,OAAO,IAAI,EAAO,KAAK,KAAM,KAAK,IAAK,KAAK,IAAK,KAAK,IAAK,KAAK,KAGlE,IAAI,WAAqB,CACvB,OAAO,KAAK,MAAQ,IAAA,IAAa,KAAK,MAAQ,IAAA,GAGhD,IAAI,WAAqB,CACvB,OAAO,KAAK,MAAQ,KAAK,aAAe,KAAK,MAAQ,KAAK,YAG5D,IAAI,mBAA6B,CAC/B,OAAO,KAAK,WAAa,CAAC,KAAK,UAGjC,IAAI,KAAc,CAChB,OAAO,KAAK,MAAQ,IAAA,IAAa,KAAK,MAAQ,IAAA,GAC1C,CAAC,KAAK,IAAK,KAAK,KAAK,IAAI,GAAwB,KAAK,MACtD,KAIR,SAAS,EAAuB,EAAe,CAC7C,OAAO,EAAQ,GAAM,EAAI,EAAM,QAAQ,GAAK,EAG9C,SAAS,EAAiB,EAA2B,EAAiB,EAAuB,CAC3F,OAAO,OAAO,GAAU,SAAW,CAAC,EAAM,QAAQ,GAAkB,EC1CtE,MAAa,EAAmB,CAE9B,IAAK,OAEL,SAAU,QAEV,kBAAmB,SCzBrB,SAAS,EAAiB,EAAK,CAC3B,OAAO,IAAQ,YCDnB,SAAS,EAAa,EAAO,CACzB,OAAO,OAAO,GAAU,YAAY,ECExC,SAAS,EAAU,EAAQ,EAAQ,EAAO,CACtC,IAAM,EAAa,OAAO,KAAK,GAC/B,IAAK,IAAI,EAAI,EAAG,EAAI,EAAW,OAAQ,IAAK,CACxC,IAAM,EAAM,EAAW,GACvB,GAAI,EAAiB,GACjB,SAEJ,IAAM,EAAc,EAAO,GACrB,EAAc,EAAO,GACrB,EAAS,EAAM,EAAa,EAAa,EAAK,EAAQ,GACxD,IAAW,IAAA,GAGN,MAAM,QAAQ,GACnB,EAAO,GAAO,EAAU,GAAe,GAAI,EAAa,GAEnD,EAAa,IAAgB,EAAa,GAC/C,EAAO,GAAO,EAAU,GAAe,GAAI,EAAa,IAEnD,IAAgB,IAAA,IAAa,IAAgB,IAAA,MAClD,EAAO,GAAO,GATd,EAAO,GAAO,EAYtB,OAAO,ECsEX,eAAsB,EAAe,EAAyD,CACxF,OAAO,GAAW,WACpB,EAAS,EAAO,MAAM,MAGxB,IAAM,EAAM,IAAI,IACd,EAAW,CACT,KAAM,cACN,QAAS,IACT,OAAQ,YACR,UAAW,SAKT,EAAU,EAAO,QAAQ,EAAK,EAAO,EAAO,KAChD,EAAI,aAAa,IAAI,SAAW,EAAmB,MAAM,EAAG,GAAO,KAAK,MACjE,EAAI,WAAW,OAAS,IAAO,EAAI,OAAO,GAAS,GACzD,IAEH,GAAI,EAAO,OAAS,EAAQ,OAAQ,CAClC,IAAM,EAAc,MAAM,QAAQ,IAAI,CACpC,EAAe,GACf,EAAe,EAAO,MAAM,EAAQ,WAEtC,OAAO,EAAY,OAGrB,EAAI,aAAa,IAAI,SAAU,EAAO,KAAK,KAAK,QAAQ,KAAM,MAC9D,IAAM,EAAO,MAAM,EAAoC,GACjD,EAAQ,GAAM,OAAO,OAAS,GACpC,OAAO,OAAO,QAAQ,GAAO,KAAK,CAAC,EAAQ,MAClC,CACL,OAAQ,SAAS,GACjB,KAAM,EAAK,MACX,IAAK,sCAAsC,EAAK,QAChD,SAAS,EAAgB,CACvB,OAAO,EAAY,KAAK,KAAM,IAEhC,YAAa,IAAI,EACf,WACA,GAAG,EAAS,EAAK,aAAa,KAAK,GAAK,EAAE,UAAY,IAAM,EAAE,OAAS,YAEzE,eAAgB,IAAI,EAClB,kBACA,GAAG,EAAS,EAAK,aAAa,KAAK,GAAK,EAAE,OAAS,eAKzD,SAAS,EAAS,EAA+C,CAC/D,OAAO,OAAO,GAAM,SAAW,CAAC,EAAE,IAAK,EAAE,KAAO,CAAC,IAAA,GAAW,IAAA,KAchE,eAAsB,EACpB,EACA,EAAO,+CACP,EAAS,kBACa,CACtB,IAAM,EAAS,CACb,OACA,QAAS,EACT,SACA,oBAAqB,2CACrB,sBAAuB,SAAS,KAAK,cAAe,KACpD,GAAI,EAAK,SAAS,cAAgB,CAAC,OAAQ,WAAa,GACxD,GAAI,EAAK,SAAS,aAAe,CAAC,QAAS,IAAK,OAAQ,WAAa,IAEjE,EAAO,MAAM,EAAiC,GAC9CqB,EAAgC,GAAM,OAAO,QAAQ,GACrD,GAAc,GAAM,YAAc,IAAI,IAAI,GAC9C,EAAS,MAAM,QAAQ,aAAc,KAEjC,EAAc,GAAM,UAAU,IAAI,YACxC,MAAO,CACL,aACA,YAAa,GAAa,kBAAkB,MAC5C,OAAQ,GAAa,QAAQ,MAC7B,UAAW,GAAa,kBAAkB,MAC1C,GAAI,EAAO,SAAS,OAAS,CAAC,IAAK,GAAM,UAAU,IAAI,gBAAkB,GACzE,eAAgB,EAAsB,GACtC,GAAG,EAAiB,IAGtB,SAAS,EAAiB,EAAyC,CACjE,IAAM,EAAO,GAAM,YAAY,IAAI,OAAO,UAAU,KACpD,GAAI,CAAC,EAAM,MAAO,GAClB,IAAMC,EAAuB,KAAK,MAAM,GAClC,EAAc,EAClB,WACA,EAAU,WAAW,EAAiB,YAAe,IAEjD,EAAiB,EACrB,kBACA,EAAU,WAAW,EAAiB,sBAAsB,IAE9D,MAAO,CACL,GAAI,EAAc,CAAC,eAAe,GAClC,GAAI,EAAiB,CAAC,kBAAkB,IAI5C,SAAS,EACP,EACA,EACoB,CAChB,MAAW,SAAS,WAAW,OAAS,kBAG5C,OAAO,IAAI,EACT,EACA,GAAW,SAAS,UAAU,MAAM,SACpC,GAAW,SAAS,UAAU,MAAM,WAIxC,SAAS,EAAsB,EAAmB,CAChD,GAAI,CACF,IAAMC,EAAmB,GAAM,YAAY,IAAI,OAAO,KAAK,MAAQ,GAC7D,EAAS,EAAS,MACtB,6GAEI,EAAM,EAAS,MAAM,iEACvB,EACA,EAUJ,OATI,GACF,EAAM,SAAS,EAAO,IAAM,SAAS,EAAO,IAAM,GAAK,WAAW,EAAO,IAAM,KAC/E,GAAO,EAAO,KAAO,IAAM,EAAI,GAC/B,EAAM,SAAS,EAAO,IAAM,SAAS,EAAO,IAAM,GAAK,WAAW,EAAO,IAAM,KAC/E,GAAO,EAAO,KAAO,IAAM,EAAI,IACtB,IACT,EAAM,WAAW,EAAI,IACrB,EAAM,WAAW,EAAI,KAEhB,IAAI,EAAO,kBAAmB,EAAK,QACpC,CACN,OAAO,IAAI,EAAO,kBAAmB,IAAA,GAAW,IAAA,MAKtD,eAAsB,EAAuB,EAAyC,CACpF,IAAM,EAAS,CACb,KAAM,WACN,YAAa,GACb,QAAS,GACT,OAAQ,EACR,SAAU,GAEN,EAAO,MAAM,EAA0B,EAAQ,GAAI,IAAA,OAAiB,IAC1E,OAAQ,EAAK,MAAM,UAAY,IAAI,IAAI,GAAK,EAAE,MAAM,QAAQ,aAAc,KAG5E,eAAsB,EAAkB,EAAmC,CACzE,IAAM,EAAS,CACb,KAAM,WACN,QAAS,GACT,OAAQ,EACR,UAAW,GAEP,EAAO,MAAM,EAA0B,EAAQ,GAAI,IAAA,OAAiB,IAC1E,OAAQ,EAAK,MAAM,UAAY,IAAI,IAAI,GAAK,EAAE,MAahD,eAAsB,EAAS,CAC7B,QACA,OACA,YACA,YACA,UACA,WACA,iBAGA,CAIA,GAHI,OAAO,GAAU,WACnB,EAAQ,EAAM,MAAM,MAElB,EACF,OAAO,EAAM,IAAI,GAAS,EAAK,WAAW,SAAW,EAAO,QAAQ,QAC3D,EAAM,CACf,IAAM,EAAa,OAAO,GAAc,SAAW,CAAC,EAAY,EAChE,OAAO,EAAgB,EAAM,EAAY,EAAW,WAC3C,EAAU,CACnB,IAAM,EAAiB,OAAO,GAAkB,SAAW,CAAC,EAAgB,EAC5E,OAAO,EAAoB,EAAU,QAErC,MAAU,QAgBd,eAAsB,EAAU,EAA8C,CAC5E,IAAM,EAAS,CACb,KAAM,YACN,YAAa,EACb,QAAS,IACT,OAAQ,YACR,OAAQ,CAAC,EAAO,WAAY,EAAO,UAAW,EAAO,WAAY,EAAO,WAAW,KAAK,MAEpF,EAAO,MAAM,EAA+B,EAAQ,IAC1D,OAAQ,EAAK,OAAO,WAAa,IAAI,IAClC,IAAqB,CACpB,OAAQ,EAAG,OACX,KAAM,EAAG,MACT,IAAK,sCAAsC,EAAG,QAC9C,SAAS,EAAgB,CACvB,OAAO,EAAY,KAAK,KAAM,IAEhC,YAAa,IAAI,EAAO,WAAY,EAAG,IAAK,EAAG,KAC/C,eAAgB,IAAI,EAAO,kBAAmB,IAAA,GAAW,IAAA,OAK/D,SAAS,EAAoB,EAAgB,EAAwB,CASnE,OAPI,EAAO,WAAW,yCACpB,EAAS,EAAO,MAAM,IACtB,EAAS,UAAU,IAEjB,EAAO,WAAW,KACpB,EAAS,EAAO,MAAM,EAAO,SAExB,EAGT,eAAsB,EACpB,EACA,EACA,EACA,EACyB,CACzB,EAAO,EAAoB,EAAM,SAEjC,IAAM,EAAS,CACb,UAAW,YACX,QAAS,EACT,SAAU,OAAO,GAAc,UAAY,GAAa,IAAM,EAAY,MAC1E,SAAU,EAAU,IAAI,KAAK,GAAS,cAAgB,IAAA,GACtD,OAAQ,EAAY,IAAI,KAAK,GAAW,cAAgB,IAAA,GACxD,QAAS,YACT,OAAQ,SAEJ,EAAe,GAAoC,OAAO,OAAO,EAAK,MAAM,OAC5E,EAAkB,GACtB,EAAK,SAAW,CAAC,GAAa,EAAY,GAAM,OAAS,EAAY,GACjE,EAAO,MAAM,EAA0B,EAAQ,GAAI,IAAA,GAAW,GAC9D,EAAQ,EAAY,GAAM,IAAI,GAAQ,EAAK,OACjD,OAAO,EAAY,EAAM,MAAM,EAAG,GAAa,EAGjD,eAAsB,EAAoB,EAAa,EAAQ,EAA4B,CACzF,EAAM,EAAoB,EAAK,aAC/B,IAAM,EAAQ,IAAI,gBACZ,EAAW,CACf,EAAqB,EAAK,EAAO,EAAM,QACvC,EAAqB,EAAK,EAAO,EAAM,QACvC,EAAqB,EAAK,EAAO,EAAM,SAErC,GAAS,GACX,EAAS,QAAQ,EAAqB,EAAK,EAAM,SAEnD,GAAI,CACF,OAAO,MAAM,IAAI,SAAyB,EAAS,IAAW,CAE5D,IAAK,IAAM,KAAW,EACpB,EAAQ,KAAK,EAAS,GAAS,CACzB,aAAiB,cAAgB,EAAM,OAAS,cACpD,QAAQ,KAAK,0BAA2B,EAAK,KAIjD,QAAQ,WAAW,GAAU,MAAM,YAE7B,CACR,EAAM,SAIV,eAAsB,EACpB,EACA,EACyB,CACzB,IAAM,EAAS,CACb,KAAM,kBACN,QAAS,IACT,YAAa,EACb,QAAS,YAAc,GAEnB,EAAO,MAAM,EAA0B,EAAQ,GAAI,GACzD,OAAQ,EAAK,MAAM,iBAAmB,IAAI,IAAI,GAAM,EAAG,OAGzD,eAAsB,EACpB,EACA,EACA,EACyB,CACzB,IAAM,EAAS,CACb,KAAM,UACN,IAAK,EAAI,QAAQ,aAAc,IAC/B,KAAM,EACN,QACA,KAAM,GAEF,EAAM,mCAAqC,EAAe,GAC1D,EAAO,MAAM,EAA0B,EAAK,CAAC,WACnD,OAAO,EAAK,IAAI,GAAK,QAAQ,KAG/B,eAAsB,EACpB,EACA,EACA,EACyB,CACzB,IAAM,EAAS,CACb,SAAU,EAAI,QAAQ,aAAc,IACpC,GAAI,EACJ,SAEI,EAAM,YAAc,EAAe,GACnC,EAAO,MAAM,EAAmC,EAAK,CAAC,WAC5D,OAAO,EAAK,MAAM,IAAI,GAAK,QAAQ,KAGrC,eAAsB,EACpB,EACA,EACA,EACyB,CACzB,IAAM,EAAS,CACb,SAAU,UACV,QAAS,YACT,QACA,aACC,QAAmB,EACpB,OAAQ,OACR,OAAQ,EACR,KAAM,GAEF,EAAM,gCAAkC,EAAe,GAEvD,EAAO,MAAM,EAAe,EAAK,CAAC,WACxC,OAAO,EAAK,KAAK,GAAG,EAAK,KAG3B,SAAS,EAAW,EAAiC,GAAI,CACvD,IAAM,EAAS,CACb,OAAQ,QACR,OAAQ,OACR,OAAQ,IACR,GAAG,GAEC,EAAM,2CAAgB,EAAe,GAC3C,OAAO,EAIT,eAAe,EACb,EACA,EAAkB,GAClB,EACA,EAAkB,GAAY,CAAC,CAAC,EAAK,SACzB,CACZ,IAAM,EAAM,aAAiB,IAAM,EAAM,WAAa,EAAW,GAC7D,EAAO,MAAM,EAAa,EAAK,CACjC,WAeF,MAbA,GAAO,EAAU,EAAiB,GAAO,EAAG,IAAM,CAChD,GAAI,MAAM,QAAQ,IAAM,MAAM,QAAQ,GACpC,MAAO,GAAG,OAAO,GAAG,EAAG,GAAG,KAG1B,EAAe,GACV,EACL,CAAC,GAAG,EAAO,SAAU,IAAA,GAAW,GAAG,EAAK,UACxC,CAAC,GAAG,EAAM,SAAU,IAAA,IACpB,EACA,GAGG,EAGT,SAAS,EAAe,EAAiD,CACvE,IAAM,EAAe,IAAI,gBACzB,IAAK,GAAM,CAAC,EAAK,KAAU,OAAO,QAAQ,GAAQ,CAChD,GAAI,IAAU,IAAA,GAAW,SACzB,EAAa,OAAO,EAAK,OAAO,IAElC,OAAO,EAGT,eAAe,EAAa,EAAkB,EAAmC,CAC/E,QAAQ,IAAI,WAAY,GACxB,IAAM,EAAM,MAAM,MAAM,EAAK,CAC3B,MAAO,WACP,QAAS,CAAC,OAAQ,oBAClB,GAAG,IAEL,GAAI,EAAI,GACN,OAAO,EAAI,OAEX,MAAU,MAAM,EAAI"}